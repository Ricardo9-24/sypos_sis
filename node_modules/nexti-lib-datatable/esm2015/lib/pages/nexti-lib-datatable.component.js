import { CurrencyPipe, DatePipe } from '@angular/common';
import { Component, EventEmitter, Input, Output, ViewChild, ViewChildren, } from '@angular/core';
import * as jsPDF from 'jspdf';
import 'jspdf-autotable';
import { Angular2Txt } from 'angular2-txt/Angular2-txt';
import { ExcelService } from '../services/excel.service';
import { TableComponent } from '../component/table/table.component';
var NumberFormat;
(function (NumberFormat) {
    NumberFormat["NUM"] = "number";
    NumberFormat["CUR"] = "currency";
})(NumberFormat || (NumberFormat = {}));
var AlignClass;
(function (AlignClass) {
    AlignClass["LEFT"] = "text-align: start;";
    AlignClass["RIGHT"] = "text-align: end;";
})(AlignClass || (AlignClass = {}));
var FormatType;
(function (FormatType) {
    FormatType["NUM"] = "number";
    FormatType["CUR"] = "currency";
    FormatType["DIF"] = "difference";
    FormatType["COU"] = "count";
})(FormatType || (FormatType = {}));
export class NextiLibDatatableComponent {
    constructor(datePipe, currencyPipe, excelService) {
        this.datePipe = datePipe;
        this.currencyPipe = currencyPipe;
        this.excelService = excelService;
        this.titleXs = false;
        this.linkBack = false;
        this.actionState = false;
        this.paginacion = false;
        this.totalRegistros = 0;
        this.multFPP = 0;
        this.actualPage = 0;
        this.multiTable = false;
        this.sections = false;
        this.onDelete = new EventEmitter();
        this.onUpdate = new EventEmitter();
        this.onActive = new EventEmitter();
        this.onShow = new EventEmitter();
        this.onShowEvent = new EventEmitter();
        this.onBack = new EventEmitter();
        this.onfilter = new EventEmitter();
        this.onNext = new EventEmitter();
        this.onReturn = new EventEmitter();
        this.data$ = new Array();
        // TODO mejorar, con un estado de header normalizado se puede prescindir de esta variable
        this.dataPerm$ = new Array();
        this.footerRow = [];
        this.filterSelected = null;
    }
    ngOnInit() {
        var _a;
        (_a = this.selectFilter) === null || _a === void 0 ? void 0 : _a.forEach((element) => {
            if (element.selected) {
                this.filterSelected = element.value;
            }
        });
    }
    ngOnChanges(changes) {
        const { list } = changes;
        if ((list === null || list === void 0 ? void 0 : list.currentValue) !== (list === null || list === void 0 ? void 0 : list.previousValue)) {
            this.data$ = list === null || list === void 0 ? void 0 : list.currentValue;
            this.dataPerm$ = list === null || list === void 0 ? void 0 : list.currentValue;
            if (this.inputSearch)
                this.inputSearch.nativeElement.value = '';
        }
    }
    ngDoCheck() {
        var _a;
        (_a = this.datatable) === null || _a === void 0 ? void 0 : _a.forEach((element) => {
            if (this.footerConfig)
                element.getFooterData();
        });
    }
    onFilter() {
        this.onfilter.emit(this.filterSelected);
    }
    onDeleteItem(item) {
        this.onDelete.emit(item);
    }
    onUpdateItem(item) {
        this.onUpdate.emit(item);
    }
    onActiveItem(item) {
        this.onActive.emit(item);
    }
    onShowItem(item) {
        this.onShow.emit(item);
    }
    onShowItemEvent($event) {
        this.onShowEvent.emit($event);
    }
    onlyNumbers(event) {
        return event.charCode >= 48 && event.charCode <= 57;
    }
    customSearchBancoFn(term, item) {
        term = term.toLowerCase();
        return item.bancorresponsal.toLowerCase().includes(term);
    }
    customSearchCompaniesFn(term, item) {
        term = term.toLowerCase();
        return (item.ruc.includes(term) || item.razonSocial.toLowerCase().includes(term));
    }
    filter(search) {
        if (this.multiTable) {
            let datafilter = [];
            for (const list of this.dataPerm$) {
                let data = this.filterList(list, search);
                datafilter.push(data);
            }
            this.data$ = datafilter;
        }
        else {
            this.data$ = this.filterList(this.dataPerm$, search);
        }
    }
    filterList(list, search) {
        return list.filter((lista) => {
            for (const row of lista) {
                if (typeof row === 'object') {
                    if ((row.title && this.toCompareString(row.title, search)) ||
                        (row.subtitle && this.toCompareString(row.subtitle, search))) {
                        return lista;
                    }
                }
                else if (this.toCompareString(row, search)) {
                    return lista;
                }
            }
        });
    }
    toCompareString(item, search) {
        return item
            .toString()
            .toUpperCase()
            .includes(search.toString().toUpperCase());
    }
    getReportHeader() {
        const { customHeader } = this.reportConfig;
        return customHeader
            ? customHeader
            : this.header.map((item) => {
                if (typeof item === 'object') {
                    return item.title;
                }
                else {
                    return item;
                }
            });
    }
    getFormatDataToTreatment(item) {
        if (typeof item === 'object') {
            if (item != null) {
                if (item.title && item.subtitle) {
                    return `${item.title}\n${item.subtitle}`;
                }
                else {
                    return item.title ? item.title : item.subtitle && item.subtitle;
                }
            }
            else {
                return '';
            }
        }
        else {
            return item;
        }
    }
    getRawData(customTotalRows, formatedData, customTotalType, rawDataRow) {
        if (customTotalRows && customTotalRows.length) {
            customTotalRows.forEach((customIndex, indexCol) => {
                formatedData.forEach((item, index) => {
                    if (customIndex === index) {
                        let returnItem = 0;
                        customTotalType.forEach((type, indexType) => {
                            if (indexCol === indexType) {
                                switch (type) {
                                    case FormatType.NUM:
                                        if ((typeof item === 'string' &&
                                            (item == '--' || item === '')) ||
                                            typeof item === 'undefined') {
                                            returnItem = 0;
                                        }
                                        else {
                                            returnItem = Number(item);
                                        }
                                        break;
                                    case FormatType.CUR:
                                        if ((typeof item === 'string' &&
                                            (item == '--' || item === '')) ||
                                            typeof item === 'undefined') {
                                            returnItem = 0;
                                        }
                                        else {
                                            returnItem = this.formatCurrencyToNumber(item);
                                        }
                                        break;
                                    case FormatType.COU:
                                        if ((typeof item === 'string' &&
                                            (item == '--' || item === '')) ||
                                            typeof item === 'undefined') {
                                            returnItem = 0;
                                        }
                                        else {
                                            returnItem = 1;
                                        }
                                        break;
                                    default:
                                        returnItem = 0;
                                }
                            }
                        });
                        rawDataRow.push(returnItem);
                    }
                });
            });
        }
    }
    getReportBody() {
        const { customIndexRows, customTotalRows, customTotalFormatting, customTotalType, footLabel, } = this.reportConfig;
        let tableData = [];
        let tableFooterData = [];
        let rawData = [];
        this.data$.forEach((itemArray) => {
            let tableDataRow = [];
            let rawDataRow = [];
            // Step 1: format - prepare dat
            const formatedData = itemArray.map((item) => this.getFormatDataToTreatment(item));
            // Step 2: Generate Filter data
            if (customIndexRows && customIndexRows.length) {
                customIndexRows.forEach((customIndex) => {
                    formatedData.forEach((item, index) => {
                        if (customIndex === index) {
                            tableDataRow.push(item);
                        }
                    });
                });
            }
            else {
                tableDataRow = formatedData;
            }
            // Step 3: Get raw data (values to totals)
            this.getRawData(customTotalRows, formatedData, customTotalType, rawDataRow);
            tableData.push(tableDataRow);
            rawData.push(rawDataRow);
        });
        if (customTotalRows && customTotalRows.length && rawData.length) {
            let procesedTotals = [];
            procesedTotals = this.trasposeMatrix(rawData).map((itemArray) => itemArray.reduce((a, b) => a + b, 0));
            if (customTotalFormatting && customTotalFormatting.length) {
                procesedTotals = customTotalFormatting.map((format, index) => {
                    switch (format) {
                        case NumberFormat.CUR:
                            return this.currencyPipe.transform(procesedTotals[index]);
                        default:
                            return procesedTotals[index];
                    }
                });
            }
            procesedTotals = [[footLabel, ...procesedTotals]];
            tableFooterData = procesedTotals.length ? procesedTotals : null;
        }
        return {
            tableData,
            tableFooterData,
        };
    }
    generatePdf() {
        const pdf = new jsPDF.jsPDF();
        pdf.setProperties({
            title: 'Resultados Netos',
        });
        const { title, subtitle, subject, sessionDate, tableTitle } = this.reportConfig;
        const pageSize = pdf.internal.pageSize;
        const pageWidth = pageSize.width ? pageSize.width : pageSize.getWidth();
        // Section I
        pdf.autoTable({
            body: [
                [title, this.datePipe.transform(Date.now(), 'dd/MM/yyyy HH:mm')],
                [
                    {
                        content: subtitle,
                        colSpan: 2,
                        styles: { fontSize: 12, fontStyle: 'normal' },
                    },
                ],
            ],
            showHead: false,
            theme: 'plain',
            styles: {
                fillColor: [48, 84, 150],
                textColor: 255,
                valign: 'bottom',
            },
            columnStyles: {
                0: { fontStyle: 'bold', fontSize: 13 },
                1: { fontSize: 11, halign: 'right' },
            },
        });
        // Section II left
        const lastTableY = pdf.lastAutoTable.finalY + 5;
        pdf.autoTable({
            body: [[subject]],
            showHead: false,
            theme: 'plain',
            startY: lastTableY,
            styles: {
                fillColor: [255, 255, 153],
                textColor: 0,
                valign: 'bottom',
                fontSize: 11,
                fontStyle: 'bold',
                overflow: 'hidden',
            },
            margin: { right: 100 },
        });
        // Section II right
        pdf.autoTable({
            body: [
                [
                    'SESION COMPENSACION:',
                    this.datePipe.transform(sessionDate, 'dd/MM/yy, HH:mm', 'UTC'),
                ],
            ],
            showHead: false,
            theme: 'plain',
            startY: lastTableY,
            styles: {
                fillColor: [255, 255, 153],
                textColor: 0,
                valign: 'bottom',
                fontSize: 10,
                overflow: 'hidden',
            },
            margin: { left: pageWidth - 90 },
            columnStyles: {
                1: { halign: 'right' },
            },
        });
        // Section III
        pdf.autoTable({
            body: [[tableTitle]],
            showHead: false,
            theme: 'plain',
            startY: pdf.lastAutoTable.finalY + 10,
            styles: {
                fillColor: [31, 78, 120],
                textColor: 255,
                valign: 'bottom',
                fontSize: 11,
                fontStyle: 'bold',
            },
        });
        const header = [this.getReportHeader()];
        const { tableData, tableFooterData } = this.getReportBody();
        // Section IV
        const tableRenderObj = {
            head: header,
            body: tableData,
            theme: 'striped',
            showHead: 'firstPage',
            showFoot: 'lastPage',
            startY: pdf.lastAutoTable.finalY,
            headStyles: { fillColor: [214, 220, 228], textColor: 0 },
            footStyles: { fillColor: [31, 78, 120], textColor: 255 },
            foot: tableFooterData.length ? tableFooterData : false,
            styles: { fontSize: 9 },
        };
        pdf.autoTable(tableRenderObj);
        // Open PDF document in browser's new tab
        // pdf.output('pdfobjectnewwindow');
        pdf.save();
    }
    generateTxt() {
        const header = this.getReportHeader();
        const options = {
            headers: header,
            fieldSeparator: ';',
            quoteStrings: '',
            decimalseparator: ',',
        };
        let { tableData, tableFooterData } = this.getReportBody();
        tableData = [header, ...tableData];
        tableData = tableFooterData.length
            ? [...tableData, ...tableFooterData]
            : tableData;
        const data = this.convertToJSON(tableData);
        new Angular2Txt(data, 'Resultados Netos', options);
    }
    getFooterData() {
        const { customTotalRows, customTotalFormatting, customTotalType, customTotalAlign, } = this.footerConfig;
        let tableFooterData = [];
        let rawData = [];
        this.data$.forEach((itemArray) => {
            let rawDataRow = [];
            // Step 1: format - prepare dat
            const formatedData = itemArray.map((item) => this.getFormatDataToTreatment(item));
            // Step 2: Get raw data (values to totals)
            this.getRawData(customTotalRows, formatedData, customTotalType, rawDataRow);
            rawData.push(rawDataRow);
        });
        if (customTotalRows && customTotalRows.length && rawData.length) {
            let procesedTotals = [];
            procesedTotals = this.trasposeMatrix(rawData).map((itemArray) => itemArray.reduce((a, b) => a + b, 0));
            if (customTotalFormatting && customTotalFormatting.length) {
                procesedTotals = customTotalFormatting.map((format, index) => {
                    let value, align;
                    switch (format) {
                        case NumberFormat.CUR:
                            value = this.currencyPipe.transform(procesedTotals[index]);
                            break;
                        default:
                            value = procesedTotals[index];
                            break;
                    }
                    align = customTotalAlign[index];
                    return {
                        value,
                        align,
                    };
                });
            }
            tableFooterData = procesedTotals.length ? procesedTotals : null;
        }
        let finalFooterData = [];
        // Clear data
        if (customTotalRows && customTotalRows.length) {
            let cont = 0;
            for (let i = 0; i < this.header.length; i++) {
                let itemToPush;
                customTotalRows.forEach((customIndex) => {
                    if (customIndex === i) {
                        itemToPush = tableFooterData[cont];
                        cont++;
                    }
                });
                finalFooterData.push(itemToPush);
            }
        }
        this.footerRow = finalFooterData;
    }
    exportAsXLSX() {
        this.excelService.exportAsExcelFile(this.excelData, 'planilla_compensacion');
    }
    formatCurrencyToNumber(value) {
        if (value !== undefined && value !== null)
            return Number(String(value).replace(/[^0-9.-]+/g, ''));
    }
    isNumber(value) {
        let regex = /^\d*\.?\d*$/;
        return regex.test(value);
    }
    trasposeMatrix(matrix) {
        return matrix[0].map((_, colIndex) => matrix.map((row) => row[colIndex]));
    }
    convertToJSON(array) {
        var objArray = [];
        for (var i = 1; i < array.length; i++) {
            objArray[i - 1] = {};
            for (var k = 0; k < array[0].length && k < array[i].length; k++) {
                var key = array[0][k];
                let actualElement = array[i][k];
                let el = actualElement;
                if (typeof actualElement === 'string') {
                    el = actualElement.replace(/\n/g, ' ');
                }
                else if (typeof actualElement === 'undefined') {
                    el = '';
                }
                objArray[i - 1][key] = el;
            }
        }
        return objArray;
    }
    onBackItem() {
        this.onBack.emit();
    }
}
NextiLibDatatableComponent.decorators = [
    { type: Component, args: [{
                selector: 'nexti-lib-datatable',
                template: "<div class=\"card py-4 px-2 border-light shadow-sm h-full mh-100\">\r\n  <div\r\n    *ngIf=\"isLoading\"\r\n    class=\"spinner-container d-flex align-items-center flex-column text-primary\"\r\n  >\r\n    <div class=\"spinner-border spinner-size\" role=\"status\"></div>\r\n    <span class=\"mt-2 text-dark\">Cargando...</span>\r\n  </div>\r\n  <div class=\"card-body content h-full mh-100\">\r\n    <div class=\"content-header\">\r\n      <div class=\"d-flex justify-content-between align-items-center\">\r\n        <div class=\"header-title\">\r\n          <div *ngIf=\"linkBack\">\r\n            <a class=\"btn primary\" (click)=\"onBackItem()\">\r\n              <h4>\r\n                <i aria-hidden=\"true\" class=\"bi bi-arrow-left back\"></i>\r\n              </h4>\r\n            </a>\r\n          </div>\r\n          <div>\r\n            <div *ngIf=\"breadcrumbs\">\r\n              <lib-breadcrumbs [breadcrumbs]=\"breadcrumbs\"></lib-breadcrumbs>\r\n            </div>\r\n            <div>\r\n              <h5 [ngClass]=\"{ 'title-primary': true, 'text-small': titleXs }\">\r\n                {{ title }}\r\n              </h5>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div>\r\n          <ng-content></ng-content>\r\n          <button\r\n            *ngIf=\"reportConfig || excelData\"\r\n            type=\"button\"\r\n            class=\"btn btn-primary dropdown-toggle\"\r\n            data-bs-toggle=\"dropdown\"\r\n          >\r\n            Exportar a\r\n          </button>\r\n          <ul class=\"dropdown-menu\">\r\n            <ng-container *ngIf=\"!excelData; else showExcelOption\">\r\n              <li>\r\n                <a class=\"dropdown-item\" (click)=\"generatePdf()\">PDF</a>\r\n              </li>\r\n              <li>\r\n                <a class=\"dropdown-item\" (click)=\"generateTxt()\">TXT</a>\r\n              </li>\r\n            </ng-container>\r\n            <ng-template #showExcelOption>\r\n              <li>\r\n                <a class=\"dropdown-item\" (click)=\"exportAsXLSX()\">EXCEL</a>\r\n              </li>\r\n            </ng-template>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n      <ng-container *ngIf=\"customHeader; else headerOne\">\r\n        <ng-content select=\"[custom-header]\"></ng-content>\r\n      </ng-container>\r\n      <ng-template #headerOne>\r\n        <div class=\"d-flex justify-content-between align-items-center my-4\">\r\n          <div class=\"datos\">\r\n            <div *ngIf=\"infoAdicional\">\r\n              <lib-titlesecondary\r\n                [infoAdicional]=\"infoAdicional\"\r\n              ></lib-titlesecondary>\r\n            </div>\r\n          </div>\r\n          <div class=\"d-flex flex-row\" *ngIf=\"!opOcultarBuscar\">\r\n            <div\r\n              class=\"px-2 py-auto d-flex align-items-center\"\r\n              *ngIf=\"selectFilter\"\r\n            >\r\n              <select\r\n                [(ngModel)]=\"filterSelected\"\r\n                (change)=\"onFilter()\"\r\n                class=\"form-select custom-select\"\r\n                aria-label=\"filter\"\r\n              >\r\n                <option\r\n                  *ngFor=\"let item of selectFilter\"\r\n                  [selected]=\"item.selected\"\r\n                  [value]=\"item.value\"\r\n                >\r\n                  {{ item.label }}\r\n                </option>\r\n              </select>\r\n            </div>\r\n            <form class=\"d-flex\">\r\n              <div class=\"input-group custom-input-group\">\r\n                <input\r\n                  #search\r\n                  type=\"text\"\r\n                  class=\"form-control custom-input-search\"\r\n                  placeholder=\"Buscar\"\r\n                  aria-label=\"search\"\r\n                  aria-describedby=\"basic-addon1\"\r\n                  (keyup)=\"filter($event.target.value)\"\r\n                />\r\n                <span\r\n                  class=\"input-group-text custom-gruop-text\"\r\n                  id=\"basic-addon1\"\r\n                  ><i aria-hidden=\"true\" class=\"bi bi-search\"></i\r\n                ></span>\r\n              </div>\r\n            </form>\r\n          </div>\r\n        </div>\r\n      </ng-template>\r\n    </div>\r\n\r\n    <ng-container *ngIf=\"multiTable; else oneTable\">\r\n      <div class=\"content-body\">\r\n        <nav class=\"nav-content\">\r\n          <div class=\"nav nav-tabs\" id=\"nav-tab\" role=\"tablist\">\r\n            <button\r\n              *ngFor=\"let item of sections; index as i\"\r\n              class=\"nav-link\"\r\n              [ngClass]=\"{ active: i === 0 }\"\r\n              id=\"nav-{{ i }}-tab\"\r\n              data-bs-toggle=\"tab\"\r\n              [attr.data-bs-target]=\"'#nav-' + i\"\r\n              type=\"button\"\r\n              role=\"tab\"\r\n              aria-controls=\"nav-{{ i }}\"\r\n              aria-selected=\"true\"\r\n            >\r\n              {{ item }}\r\n            </button>\r\n          </div>\r\n        </nav>\r\n        <div class=\"tab-content\" id=\"nav-tabContent\">\r\n          <div\r\n            *ngFor=\"let item of header; index as i\"\r\n            [ngClass]=\"{ active: i === 0, show: i === 0 }\"\r\n            class=\"tab-pane fade\"\r\n            id=\"nav-{{ i }}\"\r\n            role=\"tabpanel\"\r\n            aria-labelledby=\"nav-{{ i }}-tab\"\r\n          >\r\n            <nexti-lib-table\r\n              [title]=\"title\"\r\n              [titleEmpty]=\"titleEmpty\"\r\n              [header]=\"item\"\r\n              [data$]=\"data$[i]\"\r\n              [footerConfig]=\"footerConfig[i]\"\r\n              [recursos]=\"recursos\"\r\n              [actionState]=\"actionState\"\r\n              (onDelete)=\"onDeleteItem($event)\"\r\n              (onUpdate)=\"onUpdateItem($event)\"\r\n              (onActive)=\"onActiveItem($event)\"\r\n              (onShow)=\"onShowItem($event)\"\r\n              (onShowEvent)=\"onShowItemEvent($event)\"\r\n              [opOcultarFooter]=\"opOcultarFooter\"\r\n              [hiddenActions]=\"hiddenActions\"\r\n              [isLoading]=\"isLoading\"\r\n              [paginacion]=\"paginacion\"\r\n              [totalRegistros]=\"totalRegistros\"\r\n              [multFPP]=\"multFPP\"\r\n              [actualPage]=\"actualPage\"\r\n              (onNext)=\"onNext()\"\r\n              (onReturn)=\"onReturn()\"\r\n            ></nexti-lib-table>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </ng-container>\r\n    <ng-template #oneTable>\r\n      <div class=\"content-onebody\">\r\n        <nexti-lib-table\r\n          [title]=\"title\"\r\n          [titleEmpty]=\"titleEmpty\"\r\n          [header]=\"header\"\r\n          [data$]=\"data$\"\r\n          [footerConfig]=\"footerConfig\"\r\n          [recursos]=\"recursos\"\r\n          [actionState]=\"actionState\"\r\n          (onDelete)=\"onDeleteItem($event)\"\r\n          (onUpdate)=\"onUpdateItem($event)\"\r\n          (onActive)=\"onActiveItem($event)\"\r\n          (onShow)=\"onShowItem($event)\"\r\n          (onShowEvent)=\"onShowItemEvent($event)\"\r\n          [opOcultarFooter]=\"opOcultarFooter\"\r\n          [hiddenActions]=\"hiddenActions\"\r\n          [isLoading]=\"isLoading\"\r\n          [paginacion]=\"paginacion\"\r\n          [totalRegistros]=\"totalRegistros\"\r\n          [actualPage]=\"actualPage\"\r\n          [multFPP]=\"multFPP\"\r\n          (onNext)=\"onNext($event)\"\r\n          (onReturn)=\"onReturn($event)\"\r\n        ></nexti-lib-table>\r\n      </div>\r\n    </ng-template>\r\n  </div>\r\n</div>\r\n",
                styles: ["@import \"https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css\";.header-title{display:flex;flex-direction:row}.tab-content{grid-area:tab-content;overflow:hidden}.tab-pane{height:100%}.breadcrumbs{margin:0;padding:0;font-size:12px;line-height:15px;color:#0f1b32}.breadcrumbs span{color:#b0b0b0}.mh-150{min-width:150px}.datos{padding-top:5px}.datos .nombre-banco{font-weight:700;font-size:16px;line-height:20px}.datos .informacion,.datos .nombre-banco{font-style:normal;display:flex;align-items:center;color:#0f1b32}.datos .informacion{font-weight:400;font-size:12px;line-height:15px}.custom-input-group{width:230px}.custom-input-search{border-right:none}.custom-input-search:focus{box-shadow:none;border-color:#ced4da}.custom-gruop-text{background:transparent}.primary{color:#0f1b32}.secondary{color:#2a8bf2}.muted{color:#585858}.mh-100{height:100%!important;max-height:100%!important}.title-primary{font-size:28px!important}.title-primary,h6{font-weight:700!important;color:#0f1b32}.btn.dropdown-toggle{display:block}a.dropdown-item{cursor:pointer}.text-size-sm{font-size:12px}.content{display:grid;width:100%;height:100%;grid-template-rows:auto 1fr;grid-template-areas:\"content-header\" \"content-body\"}.content-header{grid-area:content-header;padding:1rem 0}.content-body{grid-area:content-body;overflow:hidden;display:grid;width:100%;height:100%;grid-template-rows:auto 1fr;grid-template-areas:\"nav-content\" \"tab-content\"}.content-onebody{grid-area:content-body;overflow:hidden}.nav-content{grid-area:nav-content}.text-small{font-size:1.25rem!important}.page-container{position:relative}.page-container .spinner-container{position:absolute;z-index:100;left:50%;top:1vw}.page-container .spinner-container .spinner-size{width:3rem;height:3rem}"]
            },] }
];
NextiLibDatatableComponent.ctorParameters = () => [
    { type: DatePipe },
    { type: CurrencyPipe },
    { type: ExcelService }
];
NextiLibDatatableComponent.propDecorators = {
    header: [{ type: Input }],
    customHeader: [{ type: Input }],
    list: [{ type: Input }],
    titleEmpty: [{ type: Input }],
    title: [{ type: Input }],
    titleXs: [{ type: Input }],
    btnModal: [{ type: Input }],
    recursos: [{ type: Input }],
    selectFilter: [{ type: Input }],
    hiddenActions: [{ type: Input }],
    breadcrumbs: [{ type: Input }],
    infoAdicional: [{ type: Input }],
    linkBack: [{ type: Input }],
    reportConfig: [{ type: Input }],
    opOcultarBuscar: [{ type: Input }],
    opOcultarFooter: [{ type: Input }],
    footerConfig: [{ type: Input }],
    actionState: [{ type: Input }],
    paginacion: [{ type: Input }],
    totalRegistros: [{ type: Input }],
    multFPP: [{ type: Input }],
    actualPage: [{ type: Input }],
    excelData: [{ type: Input }],
    multiTable: [{ type: Input }],
    sections: [{ type: Input }],
    isLoading: [{ type: Input }],
    onDelete: [{ type: Output }],
    onUpdate: [{ type: Output }],
    onActive: [{ type: Output }],
    onShow: [{ type: Output }],
    onShowEvent: [{ type: Output }],
    onBack: [{ type: Output }],
    onfilter: [{ type: Output }],
    onNext: [{ type: Output }],
    onReturn: [{ type: Output }],
    inputSearch: [{ type: ViewChild, args: ['search',] }],
    datatable: [{ type: ViewChildren, args: [TableComponent,] }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmV4dGktbGliLWRhdGF0YWJsZS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9uZXh0aS1saWItZGF0YXRhYmxlL3NyYy9saWIvcGFnZXMvbmV4dGktbGliLWRhdGF0YWJsZS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFlBQVksRUFBRSxRQUFRLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUN6RCxPQUFPLEVBQ0wsU0FBUyxFQUVULFlBQVksRUFDWixLQUFLLEVBRUwsTUFBTSxFQUdOLFNBQVMsRUFDVCxZQUFZLEdBQ2IsTUFBTSxlQUFlLENBQUM7QUFFdkIsT0FBTyxLQUFLLEtBQUssTUFBTSxPQUFPLENBQUM7QUFDL0IsT0FBTyxpQkFBaUIsQ0FBQztBQUV6QixPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sMkJBQTJCLENBQUM7QUFDeEQsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLDJCQUEyQixDQUFDO0FBQ3pELE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxvQ0FBb0MsQ0FBQztBQUVwRSxJQUFLLFlBR0o7QUFIRCxXQUFLLFlBQVk7SUFDZiw4QkFBYyxDQUFBO0lBQ2QsZ0NBQWdCLENBQUE7QUFDbEIsQ0FBQyxFQUhJLFlBQVksS0FBWixZQUFZLFFBR2hCO0FBRUQsSUFBSyxVQUdKO0FBSEQsV0FBSyxVQUFVO0lBQ2IseUNBQTJCLENBQUE7SUFDM0Isd0NBQTBCLENBQUE7QUFDNUIsQ0FBQyxFQUhJLFVBQVUsS0FBVixVQUFVLFFBR2Q7QUFFRCxJQUFLLFVBS0o7QUFMRCxXQUFLLFVBQVU7SUFDYiw0QkFBYyxDQUFBO0lBQ2QsOEJBQWdCLENBQUE7SUFDaEIsZ0NBQWtCLENBQUE7SUFDbEIsMkJBQWEsQ0FBQTtBQUNmLENBQUMsRUFMSSxVQUFVLEtBQVYsVUFBVSxRQUtkO0FBcUNELE1BQU0sT0FBTywwQkFBMEI7SUFnRHJDLFlBQ1Us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QUFNO3VCQUNOLE1BQU07cUJBQ04sTUFBTTt1QkFDTixNQUFNOzBCQUNOLFNBQVMsU0FBQyxRQUFRO3dCQUNsQixZQUFZLFNBQUMsY0FBYyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEN1cnJlbmN5UGlwZSwgRGF0ZVBpcGUgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xyXG5pbXBvcnQge1xyXG4gIENvbXBvbmVudCxcclxuICBFbGVtZW50UmVmLFxyXG4gIEV2ZW50RW1pdHRlcixcclxuICBJbnB1dCxcclxuICBPbkluaXQsXHJcbiAgT3V0cHV0LFxyXG4gIFF1ZXJ5TGlzdCxcclxuICBTaW1wbGVDaGFuZ2VzLFxyXG4gIFZpZXdDaGlsZCxcclxuICBWaWV3Q2hpbGRyZW4sXHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcblxyXG5pbXBvcnQgKiBhcyBqc1BERiBmcm9tICdqc3BkZic7XHJcbmltcG9ydCAnanNwZGYtYXV0b3RhYmxlJztcclxuXHJcbmltcG9ydCB7IEFuZ3VsYXIyVHh0IH0gZnJvbSAnYW5ndWxhcjItdHh0L0FuZ3VsYXIyLXR4dCc7XHJcbmltcG9ydCB7IEV4Y2VsU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL2V4Y2VsLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBUYWJsZUNvbXBvbmVudCB9IGZyb20gJy4uL2NvbXBvbmVudC90YWJsZS90YWJsZS5jb21wb25lbnQnO1xyXG5cclxuZW51bSBOdW1iZXJGb3JtYXQge1xyXG4gIE5VTSA9ICdudW1iZXInLFxyXG4gIENVUiA9ICdjdXJyZW5jeScsXHJcbn1cclxuXHJcbmVudW0gQWxpZ25DbGFzcyB7XHJcbiAgTEVGVCA9ICd0ZXh0LWFsaWduOiBzdGFydDsnLFxyXG4gIFJJR0hUID0gJ3RleHQtYWxpZ246IGVuZDsnLFxyXG59XHJcblxyXG5lbnVtIEZvcm1hdFR5cGUge1xyXG4gIE5VTSA9ICdudW1iZXInLFxyXG4gIENVUiA9ICdjdXJyZW5jeScsXHJcbiAgRElGID0gJ2RpZmZlcmVuY2UnLFxyXG4gIENPVSA9ICdjb3VudCcsXHJcbn1cclxuXHJcbmludGVyZmFjZSBJUmVwb3J0Q29uZmlnIHtcclxuICB0aXRsZTogc3RyaW5nO1xyXG4gIHN1YnRpdGxlOiBzdHJpbmc7XHJcbiAgc3ViamVjdDogc3RyaW5nO1xyXG4gIHNlc3Npb25EYXRlOiBEYXRlO1xyXG4gIHRhYmxlVGl0bGU6IHN0cmluZztcclxuICBjdXN0b21IZWFkZXI/OiBzdHJpbmdbXTtcclxuICBjdXN0b21JbmRleFJvd3M/OiBudW1iZXJbXTtcclxuICBjdXN0b21Ub3RhbFJvd3M/OiBudW1iZXJbXTtcclxuICBjdXN0b21Ub3RhbEZvcm1hdHRpbmc/OiBOdW1iZXJGb3JtYXRbXTtcclxuICBjdXN0b21Ub3RhbFR5cGU/OiBGb3JtYXRUeXBlW107XHJcbiAgZm9vdExhYmVsPzogc3RyaW5nO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgSUZvb3RlckNvbmZpZyB7XHJcbiAgY3VzdG9tVG90YWxSb3dzPzogbnVtYmVyW107XHJcbiAgY3VzdG9tVG90YWxGb3JtYXR0aW5nPzogTnVtYmVyRm9ybWF0W107XHJcbiAgY3VzdG9tVG90YWxUeXBlPzogRm9ybWF0VHlwZVtdO1xyXG4gIGN1c3RvbVRvdGFsQWxpZ24/OiBBbGlnbkNsYXNzW107XHJcbn1cclxuXHJcbmludGVyZmFjZSBJU2VhcmNoUGFyYW1zUHJvcHMge1xyXG4gIGJhbmNvcnJlc3BvbnNhbDogc3RyaW5nO1xyXG4gIGRlc2RlPzogc3RyaW5nO1xyXG4gIGhhc3RhPzogc3RyaW5nO1xyXG4gIHJ1Yzogc3RyaW5nO1xyXG4gIHRpcG86IHN0cmluZztcclxuICBudW1mYWN0dXJhPzogc3RyaW5nO1xyXG59XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ25leHRpLWxpYi1kYXRhdGFibGUnLFxyXG4gIHRlbXBsYXRlVXJsOiAnLi9uZXh0aS1saWItZGF0YXRhYmxlLmNvbXBvbmVudC5odG1sJyxcclxuICBzdHlsZVVybHM6IFsnLi9uZXh0aS1saWItZGF0YXRhYmxlLmNvbXBvbmVudC5zYXNzJ10sXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBOZXh0aUxpYkRhdGF0YWJsZUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XHJcbiAgQElucHV0KCkgaGVhZGVyOiBBcnJheTxhbnk+O1xyXG4gIEBJbnB1dCgpIGN1c3RvbUhlYWRlcj86IGJvb2xlYW47XHJcbiAgQElucHV0KCkgbGlzdDogQXJyYXk8YW55PjtcclxuICBASW5wdXQoKSB0aXRsZUVtcHR5OiBzdHJpbmc7XHJcbiAgQElucHV0KCkgdGl0bGU6IHN0cmluZztcclxuICBASW5wdXQoKSB0aXRsZVhzOiBib29sZWFuID0gZmFsc2U7XHJcbiAgQElucHV0KCkgYnRuTW9kYWw6IGJvb2xlYW47XHJcbiAgQElucHV0KCkgcmVjdXJzb3M6IGFueTtcclxuICBASW5wdXQoKSBzZWxlY3RGaWx0ZXI6IGFueTtcclxuICBASW5wdXQoKSBoaWRkZW5BY3Rpb25zOiBib29sZWFuO1xyXG4gIEBJbnB1dCgpIGJyZWFkY3J1bWJzOiBBcnJheTxhbnk+O1xyXG4gIEBJbnB1dCgpIGluZm9BZGljaW9uYWw6IEFycmF5PGFueT47XHJcbiAgQElucHV0KCkgbGlua0JhY2s6IGJvb2xlYW4gPSBmYWxzZTtcclxuICBASW5wdXQoKSByZXBvcnRDb25maWc/OiBJUmVwb3J0Q29uZmlnO1xyXG4gIEBJbnB1dCgpIG9wT2N1bHRhckJ1c2NhcjogYm9vbGVhbjtcclxuICBASW5wdXQoKSBvcE9jdWx0YXJGb290ZXI6IGJvb2xlYW47XHJcbiAgQElucHV0KCkgZm9vdGVyQ29uZmlnPzogSUZvb3RlckNvbmZpZztcclxuICBASW5wdXQoKSBhY3Rpb25TdGF0ZTogYm9vbGVhbiA9IGZhbHNlO1xyXG4gIEBJbnB1dCgpIHBhZ2luYWNpb24/OiBib29sZWFuID0gZmFsc2U7XHJcbiAgQElucHV0KCkgdG90YWxSZWdpc3Ryb3M/OiBudW1iZXIgPSAwO1xyXG4gIEBJbnB1dCgpIG11bHRGUFA/OiBudW1iZXIgPSAwO1xyXG4gIEBJbnB1dCgpIGFjdHVhbFBhZ2U/OiBudW1iZXIgPSAwO1xyXG5cclxuICBASW5wdXQoKSBleGNlbERhdGE/OiBhbnk7XHJcbiAgQElucHV0KCkgbXVsdGlUYWJsZTogYm9vbGVhbiA9IGZhbHNlO1xyXG4gIEBJbnB1dCgpIHNlY3Rpb25zOiBib29sZWFuID0gZmFsc2U7XHJcbiAgQElucHV0KCkgaXNMb2FkaW5nPzogYm9vbGVhbjtcclxuXHJcbiAgQE91dHB1dCgpIG9uRGVsZXRlID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgQE91dHB1dCgpIG9uVXBkYXRlID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgQE91dHB1dCgpIG9uQWN0aXZlID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgQE91dHB1dCgpIG9uU2hvdyA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG4gIEBPdXRwdXQoKSBvblNob3dFdmVudCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG4gIEBPdXRwdXQoKSBvbkJhY2sgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuICBAT3V0cHV0KCkgb25maWx0ZXIgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuICBAT3V0cHV0KCkgb25OZXh0ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgQE91dHB1dCgpIG9uUmV0dXJuID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgQFZpZXdDaGlsZCgnc2VhcmNoJykgaW5wdXRTZWFyY2ghOiBFbGVtZW50UmVmO1xyXG4gIEBWaWV3Q2hpbGRyZW4oVGFibGVDb21wb25lbnQpIGRhdGF0YWJsZTogUXVlcnlMaXN0PFRhYmxlQ29tcG9uZW50PjtcclxuXHJcbiAgZGF0YSQgPSBuZXcgQXJyYXk8YW55PigpO1xyXG4gIC8vIFRPRE8gbWVqb3JhciwgY29uIHVuIGVzdGFkbyBkZSBoZWFkZXIgbm9ybWFsaXphZG8gc2UgcHVlZGUgcHJlc2NpbmRpciBkZSBlc3RhIHZhcmlhYmxlXHJcbiAgZGF0YVBlcm0kID0gbmV3IEFycmF5PGFueT4oKTtcclxuICBvcmlnaW5hbExpc3Q6IEFycmF5PGFueT47XHJcbiAgZm9vdGVyUm93ID0gW107XHJcbiAgZmlsdGVyU2VsZWN0ZWQ6IGFueSA9IG51bGw7XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHJpdmF0ZSBkYXRlUGlwZTogRGF0ZVBpcGUsXHJcbiAgICBwcml2YXRlIGN1cnJlbmN5UGlwZTogQ3VycmVuY3lQaXBlLFxyXG4gICAgcHJpdmF0ZSBleGNlbFNlcnZpY2U6IEV4Y2VsU2VydmljZVxyXG4gICkge31cclxuXHJcbiAgbmdPbkluaXQoKSB7XHJcbiAgICB0aGlzLnNlbGVjdEZpbHRlcj8uZm9yRWFjaCgoZWxlbWVudCkgPT4ge1xyXG4gICAgICBpZiAoZWxlbWVudC5zZWxlY3RlZCkge1xyXG4gICAgICAgIHRoaXMuZmlsdGVyU2VsZWN0ZWQgPSBlbGVtZW50LnZhbHVlO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpOiB2b2lkIHtcclxuICAgIGNvbnN0IHsgbGlzdCB9ID0gY2hhbmdlcztcclxuICAgIGlmIChsaXN0Py5jdXJyZW50VmFsdWUgIT09IGxpc3Q/LnByZXZpb3VzVmFsdWUpIHtcclxuICAgICAgdGhpcy5kYXRhJCA9IGxpc3Q/LmN1cnJlbnRWYWx1ZTtcclxuICAgICAgdGhpcy5kYXRhUGVybSQgPSBsaXN0Py5jdXJyZW50VmFsdWU7XHJcbiAgICAgIGlmICh0aGlzLmlucHV0U2VhcmNoKSB0aGlzLmlucHV0U2VhcmNoLm5hdGl2ZUVsZW1lbnQudmFsdWUgPSAnJztcclxuICAgIH1cclxuICB9XHJcblxyXG4gIG5nRG9DaGVjaygpIHtcclxuICAgIHRoaXMuZGF0YXRhYmxlPy5mb3JFYWNoKChlbGVtZW50KSA9PiB7XHJcbiAgICAgIGlmICh0aGlzLmZvb3RlckNvbmZpZykgZWxlbWVudC5nZXRGb290ZXJEYXRhKCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIG9uRmlsdGVyKCkge1xyXG4gICAgdGhpcy5vbmZpbHRlci5lbWl0KHRoaXMuZmlsdGVyU2VsZWN0ZWQpO1xyXG4gIH1cclxuXHJcbiAgb25EZWxldGVJdGVtKGl0ZW06IGFueSkge1xyXG4gICAgdGhpcy5vbkRlbGV0ZS5lbWl0KGl0ZW0pO1xyXG4gIH1cclxuXHJcbiAgb25VcGRhdGVJdGVtKGl0ZW06IGFueSkge1xyXG4gICAgdGhpcy5vblVwZGF0ZS5lbWl0KGl0ZW0pO1xyXG4gIH1cclxuXHJcbiAgb25BY3RpdmVJdGVtKGl0ZW06IGFueSkge1xyXG4gICAgdGhpcy5vbkFjdGl2ZS5lbWl0KGl0ZW0pO1xyXG4gIH1cclxuXHJcbiAgb25TaG93SXRlbShpdGVtOiBhbnkpIHtcclxuICAgIHRoaXMub25TaG93LmVtaXQoaXRlbSk7XHJcbiAgfVxyXG5cclxuICBvblNob3dJdGVtRXZlbnQoJGV2ZW50OiBhbnkpIHtcclxuICAgIHRoaXMub25TaG93RXZlbnQuZW1pdCgkZXZlbnQpO1xyXG4gIH1cclxuXHJcbiAgb25seU51bWJlcnMoZXZlbnQpIHtcclxuICAgIHJldHVybiBldmVudC5jaGFyQ29kZSA+PSA0OCAmJiBldmVudC5jaGFyQ29kZSA8PSA1NztcclxuICB9XHJcblxyXG4gIGN1c3RvbVNlYXJjaEJhbmNvRm4odGVybTogc3RyaW5nLCBpdGVtOiBhbnkpIHtcclxuICAgIHRlcm0gPSB0ZXJtLnRvTG93ZXJDYXNlKCk7XHJcblxyXG4gICAgcmV0dXJuIGl0ZW0uYmFuY29ycmVzcG9uc2FsLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXModGVybSk7XHJcbiAgfVxyXG5cclxuICBjdXN0b21TZWFyY2hDb21wYW5pZXNGbih0ZXJtOiBzdHJpbmcsIGl0ZW06IGFueSkge1xyXG4gICAgdGVybSA9IHRlcm0udG9Mb3dlckNhc2UoKTtcclxuXHJcbiAgICByZXR1cm4gKFxyXG4gICAgICBpdGVtLnJ1Yy5pbmNsdWRlcyh0ZXJtKSB8fCBpdGVtLnJhem9uU29jaWFsLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXModGVybSlcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBmaWx0ZXIoc2VhcmNoOiBzdHJpbmcpIHtcclxuICAgIGlmICh0aGlzLm11bHRpVGFibGUpIHtcclxuICAgICAgbGV0IGRhdGFmaWx0ZXIgPSBbXTtcclxuICAgICAgZm9yIChjb25zdCBsaXN0IG9mIHRoaXMuZGF0YVBlcm0kKSB7XHJcbiAgICAgICAgbGV0IGRhdGEgPSB0aGlzLmZpbHRlckxpc3QobGlzdCwgc2VhcmNoKTtcclxuICAgICAgICBkYXRhZmlsdGVyLnB1c2goZGF0YSk7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5kYXRhJCA9IGRhdGFmaWx0ZXI7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLmRhdGEkID0gdGhpcy5maWx0ZXJMaXN0KHRoaXMuZGF0YVBlcm0kLCBzZWFyY2gpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZmlsdGVyTGlzdChsaXN0LCBzZWFyY2gpIHtcclxuICAgIHJldHVybiBsaXN0LmZpbHRlcigobGlzdGEpID0+IHtcclxuICAgICAgZm9yIChjb25zdCByb3cgb2YgbGlzdGEpIHtcclxuICAgICAgICBpZiAodHlwZW9mIHJvdyA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgKHJvdy50aXRsZSAmJiB0aGlzLnRvQ29tcGFyZVN0cmluZyhyb3cudGl0bGUsIHNlYXJjaCkpIHx8XHJcbiAgICAgICAgICAgIChyb3cuc3VidGl0bGUgJiYgdGhpcy50b0NvbXBhcmVTdHJpbmcocm93LnN1YnRpdGxlLCBzZWFyY2gpKVxyXG4gICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBsaXN0YTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMudG9Db21wYXJlU3RyaW5nKHJvdywgc2VhcmNoKSkge1xyXG4gICAgICAgICAgcmV0dXJuIGxpc3RhO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICB0b0NvbXBhcmVTdHJpbmcoaXRlbSwgc2VhcmNoKSB7XHJcbiAgICByZXR1cm4gaXRlbVxyXG4gICAgICAudG9TdHJpbmcoKVxyXG4gICAgICAudG9VcHBlckNhc2UoKVxyXG4gICAgICAuaW5jbHVkZXMoc2VhcmNoLnRvU3RyaW5nKCkudG9VcHBlckNhc2UoKSk7XHJcbiAgfVxyXG5cclxuICBnZXRSZXBvcnRIZWFkZXIoKTogc3RyaW5nW10ge1xyXG4gICAgY29uc3QgeyBjdXN0b21IZWFkZXIgfSA9IHRoaXMucmVwb3J0Q29uZmlnO1xyXG5cclxuICAgIHJldHVybiBjdXN0b21IZWFkZXJcclxuICAgICAgPyBjdXN0b21IZWFkZXJcclxuICAgICAgOiB0aGlzLmhlYWRlci5tYXAoKGl0ZW0pID0+IHtcclxuICAgICAgICAgIGlmICh0eXBlb2YgaXRlbSA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGl0ZW0udGl0bGU7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gaXRlbTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldEZvcm1hdERhdGFUb1RyZWF0bWVudChpdGVtKSB7XHJcbiAgICBpZiAodHlwZW9mIGl0ZW0gPT09ICdvYmplY3QnKSB7XHJcbiAgICAgIGlmIChpdGVtICE9IG51bGwpIHtcclxuICAgICAgICBpZiAoaXRlbS50aXRsZSAmJiBpdGVtLnN1YnRpdGxlKSB7XHJcbiAgICAgICAgICByZXR1cm4gYCR7aXRlbS50aXRsZX1cXG4ke2l0ZW0uc3VidGl0bGV9YDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmV0dXJuIGl0ZW0udGl0bGUgPyBpdGVtLnRpdGxlIDogaXRlbS5zdWJ0aXRsZSAmJiBpdGVtLnN1YnRpdGxlO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gJyc7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBpdGVtO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZ2V0UmF3RGF0YShjdXN0b21Ub3RhbFJvd3MsIGZvcm1hdGVkRGF0YSwgY3VzdG9tVG90YWxUeXBlLCByYXdEYXRhUm93KSB7XHJcbiAgICBpZiAoY3VzdG9tVG90YWxSb3dzICYmIGN1c3RvbVRvdGFsUm93cy5sZW5ndGgpIHtcclxuICAgICAgY3VzdG9tVG90YWxSb3dzLmZvckVhY2goKGN1c3RvbUluZGV4LCBpbmRleENvbCkgPT4ge1xyXG4gICAgICAgIGZvcm1hdGVkRGF0YS5mb3JFYWNoKChpdGVtLCBpbmRleCkgPT4ge1xyXG4gICAgICAgICAgaWYgKGN1c3RvbUluZGV4ID09PSBpbmRleCkge1xyXG4gICAgICAgICAgICBsZXQgcmV0dXJuSXRlbSA9IDA7XHJcblxyXG4gICAgICAgICAgICBjdXN0b21Ub3RhbFR5cGUuZm9yRWFjaCgodHlwZSwgaW5kZXhUeXBlKSA9PiB7XHJcbiAgICAgICAgICAgICAgaWYgKGluZGV4Q29sID09PSBpbmRleFR5cGUpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAodHlwZSkge1xyXG4gICAgICAgICAgICAgICAgICBjYXNlIEZvcm1hdFR5cGUuTlVNOlxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgICAgICAgICh0eXBlb2YgaXRlbSA9PT0gJ3N0cmluZycgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgKGl0ZW0gPT0gJy0tJyB8fCBpdGVtID09PSAnJykpIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlb2YgaXRlbSA9PT0gJ3VuZGVmaW5lZCdcclxuICAgICAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICAgIHJldHVybkl0ZW0gPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm5JdGVtID0gTnVtYmVyKGl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgY2FzZSBGb3JtYXRUeXBlLkNVUjpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAodHlwZW9mIGl0ZW0gPT09ICdzdHJpbmcnICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChpdGVtID09ICctLScgfHwgaXRlbSA9PT0gJycpKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgdHlwZW9mIGl0ZW0gPT09ICd1bmRlZmluZWQnXHJcbiAgICAgICAgICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm5JdGVtID0gMDtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuSXRlbSA9IHRoaXMuZm9ybWF0Q3VycmVuY3lUb051bWJlcihpdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgIGNhc2UgRm9ybWF0VHlwZS5DT1U6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgICAgICAgKHR5cGVvZiBpdGVtID09PSAnc3RyaW5nJyAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAoaXRlbSA9PSAnLS0nIHx8IGl0ZW0gPT09ICcnKSkgfHxcclxuICAgICAgICAgICAgICAgICAgICAgIHR5cGVvZiBpdGVtID09PSAndW5kZWZpbmVkJ1xyXG4gICAgICAgICAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuSXRlbSA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgIHJldHVybkl0ZW0gPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5JdGVtID0gMDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByYXdEYXRhUm93LnB1c2gocmV0dXJuSXRlbSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZ2V0UmVwb3J0Qm9keSgpIHtcclxuICAgIGNvbnN0IHtcclxuICAgICAgY3VzdG9tSW5kZXhSb3dzLFxyXG4gICAgICBjdXN0b21Ub3RhbFJvd3MsXHJcbiAgICAgIGN1c3RvbVRvdGFsRm9ybWF0dGluZyxcclxuICAgICAgY3VzdG9tVG90YWxUeXBlLFxyXG4gICAgICBmb290TGFiZWwsXHJcbiAgICB9ID0gdGhpcy5yZXBvcnRDb25maWc7XHJcblxyXG4gICAgbGV0IHRhYmxlRGF0YSA9IFtdO1xyXG4gICAgbGV0IHRhYmxlRm9vdGVyRGF0YSA9IFtdO1xyXG4gICAgbGV0IHJhd0RhdGEgPSBbXTtcclxuXHJcbiAgICB0aGlzLmRhdGEkLmZvckVhY2goKGl0ZW1BcnJheSkgPT4ge1xyXG4gICAgICBsZXQgdGFibGVEYXRhUm93ID0gW107XHJcbiAgICAgIGxldCByYXdEYXRhUm93ID0gW107XHJcblxyXG4gICAgICAvLyBTdGVwIDE6IGZvcm1hdCAtIHByZXBhcmUgZGF0XHJcbiAgICAgIGNvbnN0IGZvcm1hdGVkRGF0YSA9IGl0ZW1BcnJheS5tYXAoKGl0ZW0pID0+XHJcbiAgICAgICAgdGhpcy5nZXRGb3JtYXREYXRhVG9UcmVhdG1lbnQoaXRlbSlcclxuICAgICAgKTtcclxuXHJcbiAgICAgIC8vIFN0ZXAgMjogR2VuZXJhdGUgRmlsdGVyIGRhdGFcclxuICAgICAgaWYgKGN1c3RvbUluZGV4Um93cyAmJiBjdXN0b21JbmRleFJvd3MubGVuZ3RoKSB7XHJcbiAgICAgICAgY3VzdG9tSW5kZXhSb3dzLmZvckVhY2goKGN1c3RvbUluZGV4KSA9PiB7XHJcbiAgICAgICAgICBmb3JtYXRlZERhdGEuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHtcclxuICAgICAgICAgICAgaWYgKGN1c3RvbUluZGV4ID09PSBpbmRleCkge1xyXG4gICAgICAgICAgICAgIHRhYmxlRGF0YVJvdy5wdXNoKGl0ZW0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0YWJsZURhdGFSb3cgPSBmb3JtYXRlZERhdGE7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIFN0ZXAgMzogR2V0IHJhdyBkYXRhICh2YWx1ZXMgdG8gdG90YWxzKVxyXG4gICAgICB0aGlzLmdldFJhd0RhdGEoXHJcbiAgICAgICAgY3VzdG9tVG90YWxSb3dzLFxyXG4gICAgICAgIGZvcm1hdGVkRGF0YSxcclxuICAgICAgICBjdXN0b21Ub3RhbFR5cGUsXHJcbiAgICAgICAgcmF3RGF0YVJvd1xyXG4gICAgICApO1xyXG5cclxuICAgICAgdGFibGVEYXRhLnB1c2godGFibGVEYXRhUm93KTtcclxuICAgICAgcmF3RGF0YS5wdXNoKHJhd0RhdGFSb3cpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKGN1c3RvbVRvdGFsUm93cyAmJiBjdXN0b21Ub3RhbFJvd3MubGVuZ3RoICYmIHJhd0RhdGEubGVuZ3RoKSB7XHJcbiAgICAgIGxldCBwcm9jZXNlZFRvdGFscyA9IFtdO1xyXG5cclxuICAgICAgcHJvY2VzZWRUb3RhbHMgPSB0aGlzLnRyYXNwb3NlTWF0cml4KHJhd0RhdGEpLm1hcCgoaXRlbUFycmF5KSA9PlxyXG4gICAgICAgIGl0ZW1BcnJheS5yZWR1Y2UoKGEsIGIpID0+IGEgKyBiLCAwKVxyXG4gICAgICApO1xyXG5cclxuICAgICAgaWYgKGN1c3RvbVRvdGFsRm9ybWF0dGluZyAmJiBjdXN0b21Ub3RhbEZvcm1hdHRpbmcubGVuZ3RoKSB7XHJcbiAgICAgICAgcHJvY2VzZWRUb3RhbHMgPSBjdXN0b21Ub3RhbEZvcm1hdHRpbmcubWFwKChmb3JtYXQsIGluZGV4KSA9PiB7XHJcbiAgICAgICAgICBzd2l0Y2ggKGZvcm1hdCkge1xyXG4gICAgICAgICAgICBjYXNlIE51bWJlckZvcm1hdC5DVVI6XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY3VycmVuY3lQaXBlLnRyYW5zZm9ybShwcm9jZXNlZFRvdGFsc1tpbmRleF0pO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgIHJldHVybiBwcm9jZXNlZFRvdGFsc1tpbmRleF07XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHByb2Nlc2VkVG90YWxzID0gW1tmb290TGFiZWwsIC4uLnByb2Nlc2VkVG90YWxzXV07XHJcblxyXG4gICAgICB0YWJsZUZvb3RlckRhdGEgPSBwcm9jZXNlZFRvdGFscy5sZW5ndGggPyBwcm9jZXNlZFRvdGFscyA6IG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgdGFibGVEYXRhLFxyXG4gICAgICB0YWJsZUZvb3RlckRhdGEsXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgZ2VuZXJhdGVQZGYoKSB7XHJcbiAgICBjb25zdCBwZGYgPSBuZXcganNQREYuanNQREYoKTtcclxuICAgIHBkZi5zZXRQcm9wZXJ0aWVzKHtcclxuICAgICAgdGl0bGU6ICdSZXN1bHRhZG9zIE5ldG9zJyxcclxuICAgIH0pO1xyXG5cclxuICAgIGNvbnN0IHsgdGl0bGUsIHN1YnRpdGxlLCBzdWJqZWN0LCBzZXNzaW9uRGF0ZSwgdGFibGVUaXRsZSB9ID1cclxuICAgICAgdGhpcy5yZXBvcnRDb25maWc7XHJcblxyXG4gICAgY29uc3QgcGFnZVNpemUgPSBwZGYuaW50ZXJuYWwucGFnZVNpemU7XHJcbiAgICBjb25zdCBwYWdlV2lkdGggPSBwYWdlU2l6ZS53aWR0aCA/IHBhZ2VTaXplLndpZHRoIDogcGFnZVNpemUuZ2V0V2lkdGgoKTtcclxuXHJcbiAgICAvLyBTZWN0aW9uIElcclxuICAgIChwZGYgYXMgYW55KS5hdXRvVGFibGUoe1xyXG4gICAgICBib2R5OiBbXHJcbiAgICAgICAgW3RpdGxlLCB0aGlzLmRhdGVQaXBlLnRyYW5zZm9ybShEYXRlLm5vdygpLCAnZGQvTU0veXl5eSBISDptbScpXSxcclxuICAgICAgICBbXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIGNvbnRlbnQ6IHN1YnRpdGxlLFxyXG4gICAgICAgICAgICBjb2xTcGFuOiAyLFxyXG4gICAgICAgICAgICBzdHlsZXM6IHsgZm9udFNpemU6IDEyLCBmb250U3R5bGU6ICdub3JtYWwnIH0sXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIF0sXHJcbiAgICAgIF0sXHJcbiAgICAgIHNob3dIZWFkOiBmYWxzZSxcclxuICAgICAgdGhlbWU6ICdwbGFpbicsXHJcbiAgICAgIHN0eWxlczoge1xyXG4gICAgICAgIGZpbGxDb2xvcjogWzQ4LCA4NCwgMTUwXSxcclxuICAgICAgICB0ZXh0Q29sb3I6IDI1NSxcclxuICAgICAgICB2YWxpZ246ICdib3R0b20nLFxyXG4gICAgICB9LFxyXG4gICAgICBjb2x1bW5TdHlsZXM6IHtcclxuICAgICAgICAwOiB7IGZvbnRTdHlsZTogJ2JvbGQnLCBmb250U2l6ZTogMTMgfSxcclxuICAgICAgICAxOiB7IGZvbnRTaXplOiAxMSwgaGFsaWduOiAncmlnaHQnIH0sXHJcbiAgICAgIH0sXHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBTZWN0aW9uIElJIGxlZnRcclxuICAgIGNvbnN0IGxhc3RUYWJsZVkgPSAocGRmIGFzIGFueSkubGFzdEF1dG9UYWJsZS5maW5hbFkgKyA1O1xyXG5cclxuICAgIChwZGYgYXMgYW55KS5hdXRvVGFibGUoe1xyXG4gICAgICBib2R5OiBbW3N1YmplY3RdXSxcclxuICAgICAgc2hvd0hlYWQ6IGZhbHNlLFxyXG4gICAgICB0aGVtZTogJ3BsYWluJyxcclxuICAgICAgc3RhcnRZOiBsYXN0VGFibGVZLFxyXG4gICAgICBzdHlsZXM6IHtcclxuICAgICAgICBmaWxsQ29sb3I6IFsyNTUsIDI1NSwgMTUzXSxcclxuICAgICAgICB0ZXh0Q29sb3I6IDAsXHJcbiAgICAgICAgdmFsaWduOiAnYm90dG9tJyxcclxuICAgICAgICBmb250U2l6ZTogMTEsXHJcbiAgICAgICAgZm9udFN0eWxlOiAnYm9sZCcsXHJcbiAgICAgICAgb3ZlcmZsb3c6ICdoaWRkZW4nLFxyXG4gICAgICB9LFxyXG4gICAgICBtYXJnaW46IHsgcmlnaHQ6IDEwMCB9LFxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gU2VjdGlvbiBJSSByaWdodFxyXG4gICAgKHBkZiBhcyBhbnkpLmF1dG9UYWJsZSh7XHJcbiAgICAgIGJvZHk6IFtcclxuICAgICAgICBbXHJcbiAgICAgICAgICAnU0VTSU9OIENPTVBFTlNBQ0lPTjonLFxyXG4gICAgICAgICAgdGhpcy5kYXRlUGlwZS50cmFuc2Zvcm0oc2Vzc2lvbkRhdGUsICdkZC9NTS95eSwgSEg6bW0nLCAnVVRDJyksXHJcbiAgICAgICAgXSxcclxuICAgICAgXSxcclxuICAgICAgc2hvd0hlYWQ6IGZhbHNlLFxyXG4gICAgICB0aGVtZTogJ3BsYWluJyxcclxuICAgICAgc3RhcnRZOiBsYXN0VGFibGVZLFxyXG4gICAgICBzdHlsZXM6IHtcclxuICAgICAgICBmaWxsQ29sb3I6IFsyNTUsIDI1NSwgMTUzXSxcclxuICAgICAgICB0ZXh0Q29sb3I6IDAsXHJcbiAgICAgICAgdmFsaWduOiAnYm90dG9tJyxcclxuICAgICAgICBmb250U2l6ZTogMTAsXHJcbiAgICAgICAgb3ZlcmZsb3c6ICdoaWRkZW4nLFxyXG4gICAgICB9LFxyXG4gICAgICBtYXJnaW46IHsgbGVmdDogcGFnZVdpZHRoIC0gOTAgfSxcclxuICAgICAgY29sdW1uU3R5bGVzOiB7XHJcbiAgICAgICAgMTogeyBoYWxpZ246ICdyaWdodCcgfSxcclxuICAgICAgfSxcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIFNlY3Rpb24gSUlJXHJcbiAgICAocGRmIGFzIGFueSkuYXV0b1RhYmxlKHtcclxuICAgICAgYm9keTogW1t0YWJsZVRpdGxlXV0sXHJcbiAgICAgIHNob3dIZWFkOiBmYWxzZSxcclxuICAgICAgdGhlbWU6ICdwbGFpbicsXHJcbiAgICAgIHN0YXJ0WTogKHBkZiBhcyBhbnkpLmxhc3RBdXRvVGFibGUuZmluYWxZICsgMTAsXHJcbiAgICAgIHN0eWxlczoge1xyXG4gICAgICAgIGZpbGxDb2xvcjogWzMxLCA3OCwgMTIwXSxcclxuICAgICAgICB0ZXh0Q29sb3I6IDI1NSxcclxuICAgICAgICB2YWxpZ246ICdib3R0b20nLFxyXG4gICAgICAgIGZvbnRTaXplOiAxMSxcclxuICAgICAgICBmb250U3R5bGU6ICdib2xkJyxcclxuICAgICAgfSxcclxuICAgIH0pO1xyXG5cclxuICAgIGNvbnN0IGhlYWRlciA9IFt0aGlzLmdldFJlcG9ydEhlYWRlcigpXTtcclxuICAgIGNvbnN0IHsgdGFibGVEYXRhLCB0YWJsZUZvb3RlckRhdGEgfSA9IHRoaXMuZ2V0UmVwb3J0Qm9keSgpO1xyXG5cclxuICAgIC8vIFNlY3Rpb24gSVZcclxuICAgIGNvbnN0IHRhYmxlUmVuZGVyT2JqOiBhbnkgPSB7XHJcbiAgICAgIGhlYWQ6IGhlYWRlcixcclxuICAgICAgYm9keTogdGFibGVEYXRhLFxyXG4gICAgICB0aGVtZTogJ3N0cmlwZWQnLFxyXG4gICAgICBzaG93SGVhZDogJ2ZpcnN0UGFnZScsXHJcbiAgICAgIHNob3dGb290OiAnbGFzdFBhZ2UnLFxyXG4gICAgICBzdGFydFk6IChwZGYgYXMgYW55KS5sYXN0QXV0b1RhYmxlLmZpbmFsWSxcclxuICAgICAgaGVhZFN0eWxlczogeyBmaWxsQ29sb3I6IFsyMTQsIDIyMCwgMjI4XSwgdGV4dENvbG9yOiAwIH0sXHJcbiAgICAgIGZvb3RTdHlsZXM6IHsgZmlsbENvbG9yOiBbMzEsIDc4LCAxMjBdLCB0ZXh0Q29sb3I6IDI1NSB9LFxyXG4gICAgICBmb290OiB0YWJsZUZvb3RlckRhdGEubGVuZ3RoID8gdGFibGVGb290ZXJEYXRhIDogZmFsc2UsXHJcbiAgICAgIHN0eWxlczogeyBmb250U2l6ZTogOSB9LFxyXG4gICAgfTtcclxuXHJcbiAgICAocGRmIGFzIGFueSkuYXV0b1RhYmxlKHRhYmxlUmVuZGVyT2JqKTtcclxuXHJcbiAgICAvLyBPcGVuIFBERiBkb2N1bWVudCBpbiBicm93c2VyJ3MgbmV3IHRhYlxyXG4gICAgLy8gcGRmLm91dHB1dCgncGRmb2JqZWN0bmV3d2luZG93Jyk7XHJcbiAgICBwZGYuc2F2ZSgpO1xyXG4gIH1cclxuXHJcbiAgZ2VuZXJhdGVUeHQoKSB7XHJcbiAgICBjb25zdCBoZWFkZXIgPSB0aGlzLmdldFJlcG9ydEhlYWRlcigpO1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSB7XHJcbiAgICAgIGhlYWRlcnM6IGhlYWRlcixcclxuICAgICAgZmllbGRTZXBhcmF0b3I6ICc7JyxcclxuICAgICAgcXVvdGVTdHJpbmdzOiAnJyxcclxuICAgICAgZGVjaW1hbHNlcGFyYXRvcjogJywnLFxyXG4gICAgfTtcclxuXHJcbiAgICBsZXQgeyB0YWJsZURhdGEsIHRhYmxlRm9vdGVyRGF0YSB9ID0gdGhpcy5nZXRSZXBvcnRCb2R5KCk7XHJcblxyXG4gICAgdGFibGVEYXRhID0gW2hlYWRlciwgLi4udGFibGVEYXRhXTtcclxuICAgIHRhYmxlRGF0YSA9IHRhYmxlRm9vdGVyRGF0YS5sZW5ndGhcclxuICAgICAgPyBbLi4udGFibGVEYXRhLCAuLi50YWJsZUZvb3RlckRhdGFdXHJcbiAgICAgIDogdGFibGVEYXRhO1xyXG5cclxuICAgIGNvbnN0IGRhdGEgPSB0aGlzLmNvbnZlcnRUb0pTT04odGFibGVEYXRhKTtcclxuICAgIG5ldyBBbmd1bGFyMlR4dChkYXRhLCAnUmVzdWx0YWRvcyBOZXRvcycsIG9wdGlvbnMpO1xyXG4gIH1cclxuXHJcbiAgZ2V0Rm9vdGVyRGF0YSgpIHtcclxuICAgIGNvbnN0IHtcclxuICAgICAgY3VzdG9tVG90YWxSb3dzLFxyXG4gICAgICBjdXN0b21Ub3RhbEZvcm1hdHRpbmcsXHJcbiAgICAgIGN1c3RvbVRvdGFsVHlwZSxcclxuICAgICAgY3VzdG9tVG90YWxBbGlnbixcclxuICAgIH0gPSB0aGlzLmZvb3RlckNvbmZpZztcclxuXHJcbiAgICBsZXQgdGFibGVGb290ZXJEYXRhID0gW107XHJcbiAgICBsZXQgcmF3RGF0YSA9IFtdO1xyXG5cclxuICAgIHRoaXMuZGF0YSQuZm9yRWFjaCgoaXRlbUFycmF5KSA9PiB7XHJcbiAgICAgIGxldCByYXdEYXRhUm93ID0gW107XHJcblxyXG4gICAgICAvLyBTdGVwIDE6IGZvcm1hdCAtIHByZXBhcmUgZGF0XHJcbiAgICAgIGNvbnN0IGZvcm1hdGVkRGF0YSA9IGl0ZW1BcnJheS5tYXAoKGl0ZW0pID0+XHJcbiAgICAgICAgdGhpcy5nZXRGb3JtYXREYXRhVG9UcmVhdG1lbnQoaXRlbSlcclxuICAgICAgKTtcclxuXHJcbiAgICAgIC8vIFN0ZXAgMjogR2V0IHJhdyBkYXRhICh2YWx1ZXMgdG8gdG90YWxzKVxyXG4gICAgICB0aGlzLmdldFJhd0RhdGEoXHJcbiAgICAgICAgY3VzdG9tVG90YWxSb3dzLFxyXG4gICAgICAgIGZvcm1hdGVkRGF0YSxcclxuICAgICAgICBjdXN0b21Ub3RhbFR5cGUsXHJcbiAgICAgICAgcmF3RGF0YVJvd1xyXG4gICAgICApO1xyXG5cclxuICAgICAgcmF3RGF0YS5wdXNoKHJhd0RhdGFSb3cpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKGN1c3RvbVRvdGFsUm93cyAmJiBjdXN0b21Ub3RhbFJvd3MubGVuZ3RoICYmIHJhd0RhdGEubGVuZ3RoKSB7XHJcbiAgICAgIGxldCBwcm9jZXNlZFRvdGFscyA9IFtdO1xyXG5cclxuICAgICAgcHJvY2VzZWRUb3RhbHMgPSB0aGlzLnRyYXNwb3NlTWF0cml4KHJhd0RhdGEpLm1hcCgoaXRlbUFycmF5KSA9PlxyXG4gICAgICAgIGl0ZW1BcnJheS5yZWR1Y2UoKGEsIGIpID0+IGEgKyBiLCAwKVxyXG4gICAgICApO1xyXG5cclxuICAgICAgaWYgKGN1c3RvbVRvdGFsRm9ybWF0dGluZyAmJiBjdXN0b21Ub3RhbEZvcm1hdHRpbmcubGVuZ3RoKSB7XHJcbiAgICAgICAgcHJvY2VzZWRUb3RhbHMgPSBjdXN0b21Ub3RhbEZvcm1hdHRpbmcubWFwKChmb3JtYXQsIGluZGV4KSA9PiB7XHJcbiAgICAgICAgICBsZXQgdmFsdWUsIGFsaWduO1xyXG5cclxuICAgICAgICAgIHN3aXRjaCAoZm9ybWF0KSB7XHJcbiAgICAgICAgICAgIGNhc2UgTnVtYmVyRm9ybWF0LkNVUjpcclxuICAgICAgICAgICAgICB2YWx1ZSA9IHRoaXMuY3VycmVuY3lQaXBlLnRyYW5zZm9ybShwcm9jZXNlZFRvdGFsc1tpbmRleF0pO1xyXG4gICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgIHZhbHVlID0gcHJvY2VzZWRUb3RhbHNbaW5kZXhdO1xyXG4gICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIGFsaWduID0gY3VzdG9tVG90YWxBbGlnbltpbmRleF07XHJcblxyXG4gICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgdmFsdWUsXHJcbiAgICAgICAgICAgIGFsaWduLFxyXG4gICAgICAgICAgfTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgdGFibGVGb290ZXJEYXRhID0gcHJvY2VzZWRUb3RhbHMubGVuZ3RoID8gcHJvY2VzZWRUb3RhbHMgOiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBmaW5hbEZvb3RlckRhdGEgPSBbXTtcclxuXHJcbiAgICAvLyBDbGVhciBkYXRhXHJcbiAgICBpZiAoY3VzdG9tVG90YWxSb3dzICYmIGN1c3RvbVRvdGFsUm93cy5sZW5ndGgpIHtcclxuICAgICAgbGV0IGNvbnQgPSAwO1xyXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuaGVhZGVyLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgbGV0IGl0ZW1Ub1B1c2g7XHJcblxyXG4gICAgICAgIGN1c3RvbVRvdGFsUm93cy5mb3JFYWNoKChjdXN0b21JbmRleCkgPT4ge1xyXG4gICAgICAgICAgaWYgKGN1c3RvbUluZGV4ID09PSBpKSB7XHJcbiAgICAgICAgICAgIGl0ZW1Ub1B1c2ggPSB0YWJsZUZvb3RlckRhdGFbY29udF07XHJcbiAgICAgICAgICAgIGNvbnQrKztcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgZmluYWxGb290ZXJEYXRhLnB1c2goaXRlbVRvUHVzaCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmZvb3RlclJvdyA9IGZpbmFsRm9vdGVyRGF0YTtcclxuICB9XHJcblxyXG4gIGV4cG9ydEFzWExTWCgpOiB2b2lkIHtcclxuICAgIHRoaXMuZXhjZWxTZXJ2aWNlLmV4cG9ydEFzRXhjZWxGaWxlKFxyXG4gICAgICB0aGlzLmV4Y2VsRGF0YSxcclxuICAgICAgJ3BsYW5pbGxhX2NvbXBlbnNhY2lvbidcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBmb3JtYXRDdXJyZW5jeVRvTnVtYmVyKHZhbHVlOiBzdHJpbmcpOiBudW1iZXIge1xyXG4gICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQgJiYgdmFsdWUgIT09IG51bGwpXHJcbiAgICAgIHJldHVybiBOdW1iZXIoU3RyaW5nKHZhbHVlKS5yZXBsYWNlKC9bXjAtOS4tXSsvZywgJycpKTtcclxuICB9XHJcblxyXG4gIGlzTnVtYmVyKHZhbHVlOiBhbnkpIHtcclxuICAgIGxldCByZWdleCA9IC9eXFxkKlxcLj9cXGQqJC87XHJcbiAgICByZXR1cm4gcmVnZXgudGVzdCh2YWx1ZSk7XHJcbiAgfVxyXG5cclxuICB0cmFzcG9zZU1hdHJpeChtYXRyaXgpIHtcclxuICAgIHJldHVybiBtYXRyaXhbMF0ubWFwKChfLCBjb2xJbmRleCkgPT4gbWF0cml4Lm1hcCgocm93KSA9PiByb3dbY29sSW5kZXhdKSk7XHJcbiAgfVxyXG5cclxuICBjb252ZXJ0VG9KU09OKGFycmF5KSB7XHJcbiAgICB2YXIgb2JqQXJyYXkgPSBbXTtcclxuICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHtcclxuICAgICAgb2JqQXJyYXlbaSAtIDFdID0ge307XHJcbiAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgYXJyYXlbMF0ubGVuZ3RoICYmIGsgPCBhcnJheVtpXS5sZW5ndGg7IGsrKykge1xyXG4gICAgICAgIHZhciBrZXkgPSBhcnJheVswXVtrXTtcclxuICAgICAgICBsZXQgYWN0dWFsRWxlbWVudCA9IGFycmF5W2ldW2tdO1xyXG4gICAgICAgIGxldCBlbCA9IGFjdHVhbEVsZW1lbnQ7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBhY3R1YWxFbGVtZW50ID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgZWwgPSBhY3R1YWxFbGVtZW50LnJlcGxhY2UoL1xcbi9nLCAnICcpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGFjdHVhbEVsZW1lbnQgPT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgICBlbCA9ICcnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBvYmpBcnJheVtpIC0gMV1ba2V5XSA9IGVsO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG9iakFycmF5O1xyXG4gIH1cclxuXHJcbiAgb25CYWNrSXRlbSgpIHtcclxuICAgIHRoaXMub25CYWNrLmVtaXQoKTtcclxuICB9XHJcbn1cclxuIl19