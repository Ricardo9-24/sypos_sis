{"version":3,"file":"manekinekko-angular-web-bluetooth.mjs","sources":["../../../../projects/manekinekko/angular-web-bluetooth/src/lib/platform/browser.ts","../../../../projects/manekinekko/angular-web-bluetooth/src/lib/platform/server.ts","../../../../projects/manekinekko/angular-web-bluetooth/src/lib/logger.service.ts","../../../../projects/manekinekko/angular-web-bluetooth/src/lib/bluetooth.service.ts","../../../../projects/manekinekko/angular-web-bluetooth/src/lib/bluetooth.module.ts","../../../../projects/manekinekko/angular-web-bluetooth/src/lib/lang/uuids/ti-sensortag2.ts","../../../../projects/manekinekko/angular-web-bluetooth/src/lib/test.utils.ts","../../../../projects/manekinekko/angular-web-bluetooth/src/public_api.ts","../../../../projects/manekinekko/angular-web-bluetooth/src/manekinekko-angular-web-bluetooth.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\n\r\n@Injectable()\r\nexport class BrowserWebBluetooth {\r\n  private ble;\r\n\r\n  constructor() {\r\n    this.ble = navigator.bluetooth;\r\n    if (!this.ble) {\r\n      throw new Error('Your browser does not support Smart Bluetooth. See http://caniuse.com/#search=Bluetooth for more details.');\r\n    }\r\n  }\r\n\r\n  requestDevice(options: RequestDeviceOptions): Promise<BluetoothDevice> {\r\n    return this.ble.requestDevice(options);\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\n\r\n@Injectable()\r\nexport class ServerWebBluetooth {\r\n  static instance() {\r\n    // mocked object for now\r\n    return {};\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\n\r\nexport interface Logger {\r\n  log(args: string[]): void;\r\n  error(args: string[]): void;\r\n  warn(args: string[]): void;\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class ConsoleLoggerService implements Logger {\r\n  log(...args) {\r\n    console.log.apply(console, args);\r\n  }\r\n  error(...args) {\r\n    console.error.apply(console, args);\r\n  }\r\n  warn(...args) {\r\n    console.warn.apply(console, args);\r\n  }\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class NoLoggerService implements Logger {\r\n  log(...args) {}\r\n  error(...args) {}\r\n  warn(...args) {}\r\n}\r\n","import { EventEmitter, Injectable } from '@angular/core';\r\nimport { from, fromEvent, Observable, throwError } from 'rxjs';\r\nimport { filter, map, mergeMap, takeUntil } from 'rxjs/operators';\r\nimport { ConsoleLoggerService } from './logger.service';\r\nimport { BrowserWebBluetooth } from './platform/browser';\r\n\r\ntype ReadValueOptions = {\r\n  acceptAllDevices?: boolean;\r\n  optionalServices?: BluetoothServiceUUID[];\r\n  characteristic: BluetoothCharacteristicUUID,\r\n  service: BluetoothServiceUUID,\r\n};\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class BluetoothCore {\r\n  private device$: EventEmitter<BluetoothDevice>;\r\n  private gatt$: EventEmitter<BluetoothRemoteGATTServer>;\r\n  private characteristicValueChanges$: EventEmitter<DataView>;\r\n  private gattServer: BluetoothRemoteGATTServer;\r\n\r\n  constructor(private readonly webBle: BrowserWebBluetooth, private readonly console: ConsoleLoggerService) {\r\n\r\n    this.device$ = new EventEmitter<BluetoothDevice>();\r\n    this.gatt$ = new EventEmitter<BluetoothRemoteGATTServer>();\r\n    this.characteristicValueChanges$ = new EventEmitter<DataView>();\r\n\r\n    this.gattServer = null;\r\n  }\r\n\r\n  getDevice$(): Observable<BluetoothDevice> {\r\n    return this.device$;\r\n  }\r\n\r\n  getGATT$(): Observable<BluetoothRemoteGATTServer> {\r\n    return this.gatt$;\r\n  }\r\n\r\n  streamValues$(): Observable<DataView> {\r\n    return this.characteristicValueChanges$.pipe(filter(value => value && value.byteLength > 0));\r\n  }\r\n\r\n  /**\r\n   * Run the discovery process and read the value form the provided service and characteristic\r\n   * @param options the ReadValueOptions\r\n   */\r\n  async value(options: ReadValueOptions) {\r\n    this.console.log('[BLE::Info] Reading value with options %o', options);\r\n\r\n    if (typeof options.acceptAllDevices === 'undefined') {\r\n      options.acceptAllDevices = true;\r\n    }\r\n\r\n    if (typeof options.optionalServices === 'undefined') {\r\n      options.optionalServices = [options.service];\r\n    }\r\n    else {\r\n      options.optionalServices = [...options.optionalServices];\r\n    }\r\n\r\n    this.console.log('[BLE::Info] Reading value with options %o', options);\r\n\r\n    try {\r\n      const device = await this.discover({\r\n        acceptAllDevices: options.acceptAllDevices,\r\n        optionalServices: options.optionalServices\r\n      }) as BluetoothDevice;\r\n      this.console.log('[BLE::Info] Device info %o', device);\r\n\r\n      const gatt = await this.connectDevice(device);\r\n      this.console.log('[BLE::Info] GATT info %o', gatt);\r\n\r\n      const primaryService = await this.getPrimaryService(gatt, options.service) as BluetoothRemoteGATTService;\r\n      this.console.log('[BLE::Info] Primary Service info %o', primaryService);\r\n\r\n      const characteristic = await this.getCharacteristic(primaryService, options.characteristic) as BluetoothRemoteGATTCharacteristic;\r\n      this.console.log('[BLE::Info] Characteristic info %o', characteristic);\r\n\r\n      const value = await characteristic.readValue();\r\n      this.console.log('[BLE::Info] Value info %o', value);\r\n\r\n      return value;\r\n    }\r\n    catch (error) {\r\n      throw new Error(error);\r\n    }\r\n  }\r\n\r\n  value$(options: ReadValueOptions) {\r\n    return from(this.value(options));\r\n  }\r\n\r\n  /**\r\n   * Run the discovery process.\r\n   *\r\n   * @param Options such as filters and optional services\r\n   * @return  The GATT server for the chosen device\r\n   */\r\n  async discover(options: RequestDeviceOptions = {} as RequestDeviceOptions): Promise<BluetoothDevice> {\r\n    options.optionalServices = options.optionalServices || ['generic_access'];\r\n\r\n    this.console.log('[BLE::Info] Requesting devices with options %o', options);\r\n\r\n    let device = null;\r\n    try {\r\n      device = await this.webBle.requestDevice(options);\r\n      device.addEventListener('gattserverdisconnected', this.onDeviceDisconnected.bind(this));\r\n\r\n      if (device) {\r\n        this.device$.emit(device);\r\n      }\r\n      else {\r\n        this.device$.error(`[BLE::Error] Can not get the Bluetooth Remote GATT Server. Abort.`);\r\n      }\r\n\r\n    } catch (error) {\r\n      this.console.error(error);\r\n    }\r\n\r\n    return device;\r\n  }\r\n\r\n  /**\r\n   * This handler will trigger when the client disconnets from the server.\r\n   *\r\n   * @param event The onDeviceDisconnected event\r\n   */\r\n  onDeviceDisconnected(event: Event) {\r\n    const disconnectedDevice = event.target as BluetoothDevice;\r\n    this.console.log('[BLE::Info] disconnected device %o', disconnectedDevice);\r\n\r\n    this.device$.emit(null);\r\n  }\r\n\r\n  /**\r\n   * Run the discovery process.\r\n   *\r\n   * @param Options such as filters and optional services\r\n   * @return  Emites the value of the requested service read from the device\r\n   */\r\n  discover$(options?: RequestDeviceOptions): Observable<void | BluetoothRemoteGATTServer> {\r\n    return from(this.discover(options)).pipe(mergeMap((device: BluetoothDevice) => this.connectDevice$(device)));\r\n  }\r\n\r\n  /**\r\n   * Connect to current device.\r\n   *\r\n   * @return  Emites the gatt server instance of the requested device\r\n   */\r\n  async connectDevice(device: BluetoothDevice) {\r\n    if (device) {\r\n      this.console.log('[BLE::Info] Connecting to Bluetooth Remote GATT Server of %o', device);\r\n\r\n      try {\r\n        const gattServer = await device.gatt.connect();\r\n        this.gattServer = gattServer;\r\n        this.gatt$.emit(gattServer);\r\n        return gattServer;\r\n      } catch (error) {\r\n        // probably the user has canceled the discovery\r\n        Promise.reject(`${error.message}`);\r\n        this.gatt$.error(`${error.message}`);\r\n      }\r\n    } else {\r\n      this.console.error('[BLE::Error] Was not able to connect to Bluetooth Remote GATT Server');\r\n      this.gatt$.error(null);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Connect to current device.\r\n   *\r\n   * @return  Emites the gatt server instance of the requested device\r\n   */\r\n  connectDevice$(device: BluetoothDevice) {\r\n    return from(this.connectDevice(device));\r\n  }\r\n\r\n  /**\r\n   * Disconnect the current connected device\r\n   */\r\n  disconnectDevice() {\r\n    if (!this.gattServer) {\r\n      return;\r\n    }\r\n    this.console.log('[BLE::Info] Disconnecting from Bluetooth Device %o', this.gattServer);\r\n\r\n    if (this.gattServer.connected) {\r\n      this.gattServer.disconnect();\r\n    } else {\r\n      this.console.log('[BLE::Info] Bluetooth device is already disconnected');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Requests the primary service.\r\n   *\r\n   * @param gatt The BluetoothRemoteGATTServer sever\r\n   * @param service The UUID of the primary service\r\n   * @return The remote service (as a Promise)\r\n   */\r\n  async getPrimaryService(gatt: BluetoothRemoteGATTServer, service: BluetoothServiceUUID): Promise<BluetoothRemoteGATTService> {\r\n    try {\r\n      const remoteService = await gatt.getPrimaryService(service);\r\n      return await Promise.resolve(remoteService);\r\n    }\r\n    catch (error) {\r\n      return await Promise.reject(`${error.message} (${service})`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Requests the primary service.\r\n   *\r\n   * @param gatt The BluetoothRemoteGATTServer sever\r\n   * @param service The UUID of the primary service\r\n   * @return The remote service (as an observable).\r\n   */\r\n  getPrimaryService$(gatt: BluetoothRemoteGATTServer, service: BluetoothServiceUUID): Observable<BluetoothRemoteGATTService> {\r\n    this.console.log('[BLE::Info] Getting primary service \"%s\" (if available) of %o', service, gatt);\r\n\r\n\r\n    if (gatt) {\r\n      return from(\r\n        this.getPrimaryService(gatt, service)\r\n      );\r\n    }\r\n    else {\r\n      return throwError(new Error('[BLE::Error] Was not able to connect to the Bluetooth Remote GATT Server'));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Requests a characteristic from the primary service.\r\n   *\r\n   * @param primaryService The primary service.\r\n   * @param characteristic The characteristic's UUID.\r\n   * @returns The characteristic description (as a Promise).\r\n   */\r\n  async getCharacteristic(\r\n    primaryService: BluetoothRemoteGATTService,\r\n    characteristic: BluetoothCharacteristicUUID\r\n  ): Promise<BluetoothRemoteGATTCharacteristic | void> {\r\n    this.console.log('[BLE::Info] Getting Characteristic \"%s\" of %o', characteristic, primaryService);\r\n\r\n    try {\r\n      const char = await primaryService.getCharacteristic(characteristic);\r\n      // listen for characteristic value changes\r\n      if (char.properties.notify) {\r\n        char.startNotifications().then(_ => {\r\n          this.console.log('[BLE::Info] Starting notifications of \"%s\"', characteristic);\r\n          char.addEventListener('characteristicvaluechanged', this.onCharacteristicChanged.bind(this));\r\n        }, (error: DOMException) => {\r\n          Promise.reject(`${error.message} (${characteristic})`);\r\n        });\r\n      }\r\n      else {\r\n        char.addEventListener('characteristicvaluechanged', this.onCharacteristicChanged.bind(this));\r\n      }\r\n      return char;\r\n    }\r\n    catch (rejectionError) {\r\n      Promise.reject(`${rejectionError.message} (${characteristic})`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Requests a characteristic from the primary service.\r\n   *\r\n   * @param primaryService The primary service.\r\n   * @param characteristic The characteristic's UUID.\r\n   * @returns The characteristic description (as a Observable).\r\n   */\r\n  getCharacteristic$(\r\n    primaryService: BluetoothRemoteGATTService,\r\n    characteristic: BluetoothCharacteristicUUID\r\n  ): Observable<void | BluetoothRemoteGATTCharacteristic> {\r\n    this.console.log('[BLE::Info] Getting Characteristic \"%s\" of %o', characteristic, primaryService);\r\n\r\n    return from(this.getCharacteristic(primaryService, characteristic));\r\n  }\r\n\r\n  /**\r\n   * Sets the characteristic's state.\r\n   *\r\n   * @param service The parent service of the characteristic.\r\n   * @param characteristic The requested characteristic\r\n   * @param state An ArrayBuffer containing the value of the characteristic.\r\n   * @return The primary service (useful for chaining).\r\n   */\r\n  setCharacteristicState(service: BluetoothServiceUUID, characteristic: BluetoothCharacteristicUUID, state: ArrayBuffer) {\r\n    const primaryService = this.getPrimaryService$(this.gattServer, service);\r\n\r\n    primaryService\r\n      // tslint:disable-next-line: variable-name\r\n      .pipe(mergeMap((_primaryService: BluetoothRemoteGATTService) => this.getCharacteristic$(_primaryService, characteristic)))\r\n      // tslint:disable-next-line: no-shadowed-variable\r\n      .subscribe((characteristic: BluetoothRemoteGATTCharacteristic) => this.writeValue$(characteristic, state));\r\n\r\n    return primaryService;\r\n  }\r\n\r\n  /**\r\n   * Enables the specified characteristic of a given service.\r\n   *\r\n   * @param service The parent service of the characteristic.\r\n   * @param characteristic The requested characteristic\r\n   * @return The primary service (useful for chaining).\r\n   */\r\n  enableCharacteristic(service: BluetoothServiceUUID, characteristic: BluetoothCharacteristicUUID, state?: any) {\r\n    state = state || new Uint8Array([1]);\r\n    return this.setCharacteristicState(service, characteristic, state);\r\n  }\r\n\r\n  /**\r\n   * Disables the specified characteristic of a given service.\r\n   *\r\n   * @param service The parent service of the characteristic.\r\n   * @param characteristic The requested characteristic.\r\n   * @return The primary service (useful for chaining).\r\n   */\r\n  disbaleCharacteristic(service: BluetoothServiceUUID, characteristic: BluetoothCharacteristicUUID, state?: any) {\r\n    state = state || new Uint8Array([0]);\r\n    return this.setCharacteristicState(service, characteristic, state);\r\n  }\r\n\r\n  /**\r\n   * Dispatches new values emitted by a characteristic.\r\n   *\r\n   * @param event the distpatched event.\r\n   */\r\n  onCharacteristicChanged(event: Event) {\r\n    this.console.log('[BLE::Info] Dispatching new characteristic value %o', event);\r\n\r\n    const value = (event.target as BluetoothRemoteGATTCharacteristic).value;\r\n    this.characteristicValueChanges$.emit(value);\r\n  }\r\n\r\n  /**\r\n   * Reads a value from the characteristics, as a DataView.\r\n   *\r\n   * @param characteristic The requested characteristic.\r\n   * @return the DataView value (as an Observable).\r\n   */\r\n  readValue$(characteristic: BluetoothRemoteGATTCharacteristic): Observable<DataView> {\r\n    this.console.log('[BLE::Info] Reading Characteristic %o', characteristic);\r\n\r\n    return from(\r\n      characteristic\r\n        .readValue()\r\n        .then((data: DataView) => Promise.resolve(data), (error: DOMException) => Promise.reject(`${error.message}`))\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Writes a value into the specified characteristic.\r\n   *\r\n   * @param characteristic The requested characteristic.\r\n   * @param value The value to be written (as an ArrayBuffer or Uint8Array).\r\n   * @return an void Observable.\r\n   */\r\n  writeValue$(characteristic: BluetoothRemoteGATTCharacteristic, value: ArrayBuffer | Uint8Array) {\r\n    this.console.log('[BLE::Info] Writing Characteristic %o', characteristic);\r\n\r\n    return from(characteristic.writeValue(value).then(_ => Promise.resolve(), (error: DOMException) => Promise.reject(`${error.message}`)));\r\n  }\r\n\r\n  /**\r\n   * A stream of DataView values emitted by the specified characteristic.\r\n   *\r\n   * @param characteristic The characteristic which value you want to observe\r\n   * @return The stream of DataView values.\r\n   */\r\n  observeValue$(characteristic: BluetoothRemoteGATTCharacteristic): Observable<DataView> {\r\n    characteristic.startNotifications();\r\n    const disconnected = fromEvent(characteristic.service.device, 'gattserverdisconnected');\r\n    return fromEvent(characteristic, 'characteristicvaluechanged')\r\n      .pipe(\r\n        map((event: Event) => (event.target as BluetoothRemoteGATTCharacteristic).value as DataView),\r\n        takeUntil(disconnected)\r\n      );\r\n  }\r\n\r\n  /**\r\n   * A utility method to convert LE to an unsigned 16-bit integer values.\r\n   *\r\n   * @param data The DataView binary data.\r\n   * @param byteOffset The offset, in byte, from the start of the view where to read the data.\r\n   * @return An unsigned 16-bit integer number.\r\n   */\r\n  littleEndianToUint16(data: any, byteOffset: number): number {\r\n    // tslint:disable-next-line:no-bitwise\r\n    return (this.littleEndianToUint8(data, byteOffset + 1) << 8) + this.littleEndianToUint8(data, byteOffset);\r\n  }\r\n\r\n  /**\r\n   * A utility method to convert LE to an unsigned 8-bit integer values.\r\n   *\r\n   * @param data The DataView binary data.\r\n   * @param byteOffset The offset, in byte, from the start of the view where to read the data.\r\n   * @return An unsigned 8-bit integer number.\r\n   */\r\n  littleEndianToUint8(data: any, byteOffset: number): number {\r\n    return data.getUint8(byteOffset);\r\n  }\r\n\r\n  /**\r\n   * Sends random data (for testing purposes only).\r\n   *\r\n   * @return Random unsigned 8-bit integer values.\r\n   */\r\n  fakeNext(fakeValue?: () => DataView) {\r\n    if (fakeValue === undefined) {\r\n      fakeValue = () => {\r\n        const dv = new DataView(new ArrayBuffer(8));\r\n        // tslint:disable-next-line:no-bitwise\r\n        dv.setUint8(0, (Math.random() * 110) | 0);\r\n        return dv;\r\n      };\r\n    }\r\n\r\n    this.characteristicValueChanges$.emit(fakeValue());\r\n  }\r\n}\r\n","import { NgModule, ModuleWithProviders, InjectionToken, Optional } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport { BluetoothCore } from './bluetooth.service';\r\nimport { BrowserWebBluetooth } from './platform/browser';\r\n\r\nimport { ConsoleLoggerService, NoLoggerService } from './logger.service';\r\n\r\nexport interface AWBOptions {\r\n  enableTracing?: boolean;\r\n}\r\n\r\nexport function browserWebBluetooth() {\r\n  return new BrowserWebBluetooth();\r\n}\r\n\r\nexport function consoleLoggerServiceConfig(options: AWBOptions) {\r\n  if (options && options.enableTracing) {\r\n    return new ConsoleLoggerService();\r\n  } else {\r\n    return new NoLoggerService();\r\n  }\r\n}\r\nexport function makeMeTokenInjector() {\r\n  return new InjectionToken('AWBOptions');\r\n}\r\n\r\n@NgModule({\r\n  imports: [CommonModule]\r\n})\r\nexport class WebBluetoothModule {\r\n  static forRoot(options: AWBOptions = {}): ModuleWithProviders<WebBluetoothModule> {\r\n    return {\r\n      ngModule: WebBluetoothModule,\r\n      providers: [\r\n        BluetoothCore,\r\n        {\r\n          provide: BrowserWebBluetooth,\r\n          useFactory: browserWebBluetooth\r\n        },\r\n        {\r\n          provide: makeMeTokenInjector,\r\n          useValue: options\r\n        },\r\n        {\r\n          provide: ConsoleLoggerService,\r\n          useFactory: consoleLoggerServiceConfig,\r\n          deps: [makeMeTokenInjector]\r\n        }\r\n      ]\r\n    };\r\n  }\r\n}\r\n","// http://processors.wiki.ti.com/images/a/a8/BLE_SensorTag_GATT_Server.pdf\r\n\r\n// prettier-ignore\r\nexport const TiTag = {\r\n\r\n  DEVICE_INFORMATION : {\r\n    SERVICE :                 'f000180a-0451-4000-b000-000000000000',\r\n    SYSTEM_ID :               'f0002a23-0451-4000-b000-000000000000',\r\n    MODEL_NUMBER :            'f0002a24-0451-4000-b000-000000000000',\r\n    SERIAL_NUMBER :           'f0002a25-0451-4000-b000-000000000000',\r\n    FIRMWARE_REV :            'f0002a26-0451-4000-b000-000000000000',\r\n    HARDWARE_REV :            'f0002a27-0451-4000-b000-000000000000',\r\n    SOFTWARE_REV :            'f0002a28-0451-4000-b000-000000000000',\r\n    MANIFACTURER :            'f0002a29-0451-4000-b000-000000000000',\r\n    IEEE11073 :               'f0002a2a-0451-4000-b000-000000000000',\r\n    PNP_ID :                  'f0002a50-0451-4000-b000-000000000000'\r\n  },\r\n\r\n  BATTERY : {\r\n    SERVICE :                 'f000180f-0451-4000-b000-000000000000',\r\n    LEVEL :                   'f0002a19-0451-4000-b000-000000000000'\r\n  },\r\n\r\n  TEMPERATURE : {\r\n    SERVICE :                 'f000aa00-0451-4000-b000-000000000000',\r\n    DATA :                    'f000aa01-0451-4000-b000-000000000000',\r\n    CONFIGURATION :           'f000aa02-0451-4000-b000-000000000000',\r\n    PERIOD :                  'f000aa03-0451-4000-b000-000000000000'\r\n  },\r\n\r\n  HUMIDITY : {\r\n    SERVICE :                 'f000aa20-0451-4000-b000-000000000000',\r\n    DATA :                    'f000aa21-0451-4000-b000-000000000000',\r\n    CONFIGURATION :           'f000aa22-0451-4000-b000-000000000000',\r\n    PERIOD :                  'f000aa23-0451-4000-b000-000000000000'\r\n  },\r\n\r\n  BAROMETER : {\r\n    SERVICE :                 'f000aa40-0451-4000-b000-000000000000',\r\n    DATA :                    'f000aa41-0451-4000-b000-000000000000',\r\n    CONFIGURATION :           'f000aa42-0451-4000-b000-000000000000',\r\n    PERIOD :                  'f000aa44-0451-4000-b000-000000000000'\r\n  },\r\n\r\n  // service not available in model CC2650\r\n  // ACCELEROMETER : {\r\n  //   SERVICE :                 'f000aa10-0451-4000-b000-000000000000',\r\n  //   DATA :                    'f000aa11-0451-4000-b000-000000000000',\r\n  //   CONFIGURATION :           'f000aa12-0451-4000-b000-000000000000',\r\n  //   PERIOD :                  'f000aa13-0451-4000-b000-000000000000'\r\n  // },\r\n\r\n  // service not available in model CC2650\r\n  // MAGNETOMETER : {\r\n  //   SERVICE :                 'f000aa30-0451-4000-b000-000000000000',\r\n  //   DATA :                    'f000aa31-0451-4000-b000-000000000000',\r\n  //   CONFIGURATION :           'f000aa32-0451-4000-b000-000000000000',\r\n  //   PERIOD :                  'f000aa33-0451-4000-b000-000000000000'\r\n  // },\r\n\r\n  // service not available in model CC2650\r\n  // GYROSCOPE : {\r\n  //   SERVICE :                 'f000aa50-0451-4000-b000-000000000000',\r\n  //   DATA :                    'f000aa51-0451-4000-b000-000000000000',\r\n  //   CONFIGURATION :           'f000aa52-0451-4000-b000-000000000000',\r\n  //   PERIOD :                  'f000aa53-0451-4000-b000-000000000000'\r\n  // },\r\n\r\n  MOVEMENT : {\r\n    SERVICE :                 'f000aa80-0451-4000-b000-000000000000',\r\n    DATA :                    'f000aa81-0451-4000-b000-000000000000',\r\n    CONFIGURATION :           'f000aa82-0451-4000-b000-000000000000',\r\n    PERIOD :                  'f000aa83-0451-4000-b000-000000000000'\r\n  },\r\n\r\n  LIGHT : {\r\n    SERVICE :                 'f000aa70-0451-4000-b000-000000000000',\r\n    DATA :                    'f000aa71-0451-4000-b000-000000000000',\r\n    CONFIGURATION :           'f000aa72-0451-4000-b000-000000000000',\r\n    PERIOD :                  'f000aa73-0451-4000-b000-000000000000'\r\n  },\r\n\r\n  KEYPRESS : {\r\n    SERVICE :                 'f000ffe0-0451-4000-b000-000000000000',\r\n    STATE :                   'f000ffe1-0451-4000-b000-000000000000'\r\n  },\r\n\r\n  __REGISTER__ : {\r\n    SERVICE :                 'f000ac00-0451-4000-b000-000000000000',\r\n    DATA :                    'f000ac01-0451-4000-b000-000000000000',\r\n    ADDRESS :                 'f000ac02-0451-4000-b000-000000000000',\r\n    DEVICE_ID :               'f000ac03-0451-4000-b000-000000000000'\r\n  },\r\n\r\n  CONTROL : {\r\n    SERVICE :                 'f000ccc0-0451-4000-b000-000000000000',\r\n    CURRENT_USED_PARAMETERS : 'f000ccc1-0451-4000-b000-000000000000',\r\n    REQUEST_NEW_PARAMETERS :  'f000ccc2-0451-4000-b000-000000000000',\r\n    DISCONNECT_REQUEST :      'f000ccc3-0451-4000-b000-000000000000'\r\n  },\r\n\r\n  OAD : {\r\n    SERVICE :                 'f000ffc0-0451-4000-b000-000000000000',\r\n    IMAGE_NOTIFY :            'f000ffc1-0451-4000-b000-000000000000',\r\n    IMAGE_BLOCK_REQUEST :     'f000ffc2-0451-4000-b000-000000000000',\r\n    IMAGE_COUNT :             'f000ffc3-0451-4000-b000-000000000000',\r\n    IMAGE_STATUS :            'f000ffc4-0451-4000-b000-000000000000'\r\n  },\r\n\r\n  IO : {\r\n    SERVICE :                 'f000aa64-0451-4000-b000-000000000000',\r\n    DATA :                    'f000aa65-0451-4000-b000-000000000000',\r\n    CONFIG :                  'f000aa66-0451-4000-b000-000000000000'\r\n  }\r\n};\r\n\r\nexport const TI_SENSORAG_SERVICES = Object.keys(TiTag).map(key => TiTag[key].SERVICE);\r\n","/*\r\n * Fake Web Bluetooth implementation\r\n * Replace real browser Bluetooth objects by a much simpler objects that implement some required functionalities\r\n */\r\n\r\nexport class FakeBluetoothDevice {\r\n  gatt: BluetoothRemoteGATTServer;\r\n  private listeners: {\r\n    [key in 'gattserverdisconnected']: EventListener[]\r\n  } = {\r\n    gattserverdisconnected: []\r\n  };\r\n\r\n  constructor(public id: string, public name: string) {\r\n  }\r\n\r\n  addEventListener(type: string, listener: EventListener) {\r\n    this.listeners[type] = [\r\n      ...this.listeners[type],\r\n      listener\r\n    ];\r\n  }\r\n\r\n  disconnect() {\r\n    const mockedEvent = {target: this} as unknown;\r\n    this.listeners.gattserverdisconnected.forEach(listener => listener(mockedEvent as Event));\r\n  }\r\n\r\n  clear() {\r\n    this.id = undefined;\r\n    this.name = undefined;\r\n    this.listeners = {\r\n      gattserverdisconnected: []\r\n    };\r\n  }\r\n}\r\n\r\nexport class FakeBluetoothRemoteGATTServer {\r\n  connected = false;\r\n\r\n  constructor(public device, public services: { [key: string]: { service, primary: boolean } }) {\r\n    device.gatt = this;\r\n  }\r\n\r\n  connect() {\r\n    this.connected = true;\r\n    return Promise.resolve(this);\r\n  }\r\n\r\n  getPrimaryService(service: BluetoothServiceUUID) {\r\n    return Promise.resolve(this.services[service].service);\r\n  }\r\n\r\n  disconnect() {\r\n    this.device.disconnect();\r\n    this.connected = false;\r\n  }\r\n}\r\n\r\nexport class FakeBluetoothRemoteGATTService {\r\n  constructor(public device, public characteristics) {\r\n    this.characteristics.service = this;\r\n  }\r\n\r\n  getCharacteristic(characteristic: BluetoothCharacteristicUUID) {\r\n    return Promise.resolve(this.characteristics[characteristic]);\r\n  }\r\n}\r\n\r\nexport class FakeBluetoothRemoteGATTCharacteristic {\r\n  value: DataView;\r\n  properties: BluetoothCharacteristicProperties;\r\n  private readonly initialValue: DataView;\r\n  private listeners: {\r\n    [key in 'characteristicvaluechanged']: EventListener[]\r\n  } = {\r\n    characteristicvaluechanged: []\r\n  };\r\n\r\n  constructor(properties: BluetoothCharacteristicProperties, initialValue?: DataView) {\r\n    this.properties = properties;\r\n    this.value = initialValue;\r\n    this.initialValue = initialValue;\r\n  }\r\n\r\n  readValue() {\r\n    return Promise.resolve(this.value);\r\n  }\r\n\r\n  addEventListener(type: string, listener: EventListener) {\r\n    this.listeners[type] = [\r\n      ...this.listeners[type],\r\n      listener\r\n    ];\r\n  }\r\n\r\n  changeValue(value: DataView) {\r\n    this.value = value;\r\n    const mockedEvent = {target: this} as unknown;\r\n    this.listeners.characteristicvaluechanged.forEach(listener => listener(mockedEvent as Event));\r\n  }\r\n\r\n  clear() {\r\n    this.value = this.initialValue;\r\n    this.listeners = {\r\n      characteristicvaluechanged: []\r\n    };\r\n  }\r\n}\r\n","/*\r\n * Public API Surface of angular-web-bluetooth\r\n */\r\n\r\nexport * from './lib/platform/browser';\r\nexport * from './lib/platform/server';\r\nexport * from './lib/bluetooth.service';\r\nexport * from './lib/logger.service';\r\nexport * from './lib/bluetooth.module';\r\nexport * from './lib/lang/uuids';\r\nexport * from './lib/test.utils';\r\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":["i1.BrowserWebBluetooth","i2.ConsoleLoggerService"],"mappings":"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"}